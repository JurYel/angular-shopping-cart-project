import{a as Ne,b as Z,c as te}from"./chunk-UJSGC2ED.js";import{A as ee,E as dt,a as at,b as D,c as b,d as $,e as B,f as Ie,g as Ee,h as j,i as ke,j as K,k as Fe,l as J,m as Ue,n as me,o as ce,p as Te,q as lt,r as st,s as Y,t as mt,u as ct,v as qe,w as X}from"./chunk-EDFPERD6.js";import{$a as we,A as T,B as ye,Ca as P,E as _,F as C,Fa as S,G as nt,Ga as ae,H as it,Ha as Qe,Ia as w,O as V,P as s,Q as h,Sa as G,Ta as Q,Ua as A,X as u,Xa as Pe,Ya as Me,Z as m,Za as ot,_a as H,a as _e,aa as ue,b as Xe,ba as i,bb as le,ca as n,da as d,ea as E,fa as k,g as F,ha as U,ia as f,ib as L,ja as p,jb as W,kb as se,lb as He,ma as q,mb as pt,p as et,pa as ie,q as O,qa as re,ra as oe,ta as a,ua as v,v as Ce,va as y,w as ve,wa as rt,xa as xe,y as be,ya as Oe,z as tt,za as Se}from"./chunk-ETE6ETIJ.js";var N=class o{constructor(r){this.http=r}serverUrl=qe.SERVER_URL;getCartIdByUsername=r=>this.http.get(`${this.serverUrl}/cart_items?username=${r}`);addCartItem=r=>this.http.post(`${this.serverUrl}/cart_items`,r);updateCustomerCart=r=>this.http.put(`${this.serverUrl}/cart_items/${r.id}`,r);getCartItems=r=>this.http.get(`${this.serverUrl}/cart_items?username=${r}`);removeCartItems=r=>this.http.delete(`${this.serverUrl}/cart_items/${r}`);static \u0275fac=function(e){return new(e||o)(be(le))};static \u0275prov=Ce({token:o,factory:o.\u0275fac,providedIn:"root"})};var ne=class o{constructor(r){this.router=r}cartItemsCount;logOut=()=>{sessionStorage.clear(),this.router.navigate(["/auth/login"])};static \u0275fac=function(e){return new(e||o)(h(L))};static \u0275cmp=T({type:o,selectors:[["app-navbar"]],inputs:{cartItemsCount:[0,"itemCountInput","cartItemsCount"]},decls:51,vars:1,consts:[[1,"navbar","navbar-expand-lg","navbar-inverse","navbar-light"],[1,"container","px-4","px-lg-5"],["routerLink","/home",1,"navbar-brand"],["type","button","data-bs-toggle","collapse","data-bs-target","#navbarSupportedContent","aria-controls","navbarSupportedContent","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarSupportedContent",1,"collapse","navbar-collapse"],[1,"navbar-nav","me-auto","mb-2","mb-lg-0","ms-lg-4"],[1,"nav-item"],["aria-current","page","routerLink","/home","routerLinkActive","router-link-active",1,"nav-link",2,"cursor","pointer"],["href","#!",1,"nav-link"],[1,"nav-item","dropdown"],["id","navbarDropdown","href","#","role","button","data-bs-toggle","dropdown","aria-expanded","false",1,"nav-link","dropdown-toggle"],["aria-labelledby","navbarDropdown",1,"dropdown-menu"],["href","#!",1,"dropdown-item"],[1,"dropdown-divider"],[1,"d-flex","align-items-center"],["type","submit","routerLink","/home/cart",1,"btn","btn-outline-light","cart"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 576 512"],["d","M0 24C0 10.7 10.7 0 24 0L69.5 0c22 0 41.5 12.8 50.6 32l411 0c26.3 0 45.5 25 38.6 50.4l-41 152.3c-8.5 31.4-37 53.3-69.5 53.3l-288.5 0 5.4 28.5c2.2 11.3 12.1 19.5 23.6 19.5L488 336c13.3 0 24 10.7 24 24s-10.7 24-24 24l-288.3 0c-34.6 0-64.3-24.6-70.7-58.5L77.4 54.5c-.7-3.8-4-6.5-7.9-6.5L24 48C10.7 48 0 37.3 0 24zM128 464a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm336-48a48 48 0 1 1 0 96 48 48 0 1 1 0-96z"],[1,"badge","bg-dark","text-white","ms-1","rounded-pill"],[1,"dropdown","ms-3"],["role","button","id","dropdownProfile","data-bs-toggle","dropdown","aria-expanded","false",1,"btn","btn-default","dropdown-toggle"],["src","assets/img/boy.png","alt",""],["aria-labelledby","dropdownProfile",1,"dropdown-menu","dropdown-menu-end"],["routerLink","/home/profile",1,"dropdown-item"],["href","#",1,"dropdown-item"],[1,"dropdown-item",3,"click"]],template:function(e,t){e&1&&(i(0,"nav",0)(1,"div",1)(2,"a",2),a(3,"Click&Get"),n(),i(4,"button",3),d(5,"span",4),n(),i(6,"div",5)(7,"ul",6)(8,"li",7)(9,"a",8),a(10,"Home"),n()(),i(11,"li",7)(12,"a",9),a(13,"About"),n()(),i(14,"li",10)(15,"a",11),a(16,"Shop"),n(),i(17,"ul",12)(18,"li")(19,"a",13),a(20,"All Products"),n()(),i(21,"li"),d(22,"hr",14),n(),i(23,"li")(24,"a",13),a(25,"Popular Items"),n()(),i(26,"li")(27,"a",13),a(28,"New Arrivals"),n()()()()(),i(29,"form",15)(30,"a",16),nt(),i(31,"svg",17),d(32,"path",18),n(),a(33," Cart "),it(),i(34,"span",19),a(35),n()(),i(36,"div",20)(37,"button",21),d(38,"img",22),n(),i(39,"ul",23)(40,"li")(41,"a",24),a(42,"Profile"),n()(),i(43,"li")(44,"a",25),a(45,"Settings"),n()(),i(46,"li"),d(47,"hr",14),n(),i(48,"li")(49,"a",26),f("click",function(){return t.logOut()}),a(50,"Logout"),n()()()()()()()()),e&2&&(s(35),v(t.cartItemsCount))},dependencies:[W,se],styles:[".navbar[_ngcontent-%COMP%]{box-shadow:0 4px 6px #0000003c;background-color:#212529;color:#ffffff80}.navbar-brand[_ngcontent-%COMP%]{font-weight:700;color:#ced4da;cursor:pointer}.navbar-brand[_ngcontent-%COMP%]:hover{color:#fff}.navbar-nav[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#ced4da;font-weight:600}.navbar-nav[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover   a[_ngcontent-%COMP%]{color:#fff}.navbar-nav[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   ul.dropdown-menu[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#1e2125;font-weight:300}.navbar-nav[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%], .navbar-nav[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a.router-link-active[_ngcontent-%COMP%]{color:#fff}.navbar-brand[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#8e44ad}.nav-link[_ngcontent-%COMP%]{color:#ced4da}.nav-link[_ngcontent-%COMP%]:hover{color:#fff}.dropdown-menu[_ngcontent-%COMP%]{right:0;left:auto}.dropdown-menu[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{cursor:pointer}.dropdown[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:35px}.cart[_ngcontent-%COMP%]{color:#ced4da;border:2px solid #ced4da;font-weight:600}.cart[_ngcontent-%COMP%]:hover{color:#212529;background-color:#fff}.cart[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:#212529}.cart[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:23px;margin-right:5px;fill:#ced4da}.cart-count[_ngcontent-%COMP%]{color:#e71717}"]})};var Ve=class o{static \u0275fac=function(e){return new(e||o)};static \u0275cmp=T({type:o,selectors:[["app-footer"]],decls:4,vars:0,consts:[[1,"py-3","bg-dark"],[1,"container"],[1,"m-0","text-center","text-white"]],template:function(e,t){e&1&&(i(0,"footer",0)(1,"div",1)(2,"p",2),a(3," Copyright \xA9 Click&Get Online Grocery Store 2024 "),n()()())}})};var Ct=["openPromptModal"];function vt(o,r){if(o&1){let e=U();E(0,46),i(1,"div",47)(2,"a",48),f("click",function(){_(e);let l=p(2);return C(l.stepDown(l.productBundleIndex))}),d(3,"i",49),n(),d(4,"input",50),i(5,"a",48),f("click",function(){_(e);let l=p(2);return C(l.stepUp(l.productBundleIndex))}),d(6,"i",51),n()(),i(7,"button",52),d(8,"i",53),a(9," Add to cart "),n(),k()}if(o&2){let e=p(2);s(4),q("id",e.productBundleIndex),m("formControlName",e.productBundleIndex)}}function bt(o,r){if(o&1){let e=U();i(0,"div",35)(1,"div",36),d(2,"img",37),n(),i(3,"div",38)(4,"div",39),a(5,"SKU: BST-498"),n(),i(6,"h1",40),a(7),n(),i(8,"div",41)(9,"span",42),a(10,"\u20B1999.00 "),n(),i(11,"span"),a(12),S(13,"currency"),n()(),i(14,"p",43),a(15," Treat yourself or a loved one to this irresistible grocery bundle, packed with popular favorites! Enjoy delicious Century Tuna, savory Palm Corned Beef, Mega Sardines, and Libby's Vienna Sausage. Plus, quick-fix meals with Lucky Me! Instant Noodles in mouthwatering flavors like Spicy Bulalo and Beef. Perfect for easy, tasty meals! "),n(),i(16,"form",44),f("ngSubmit",function(){_(e);let l=p();return C(l.addToCart(l.productBundleIndex))}),u(17,vt,10,2,"ng-container",45),n()()()}if(o&2){let e=p();s(2),q("src",e.imageUrls[e.productBundleIndex]?e.imageUrls[e.productBundleIndex]:e.itemImageName,V),s(5),v(e.productBundle.item_name),s(5),v(w(13,5,e.productBundle.unit_price,"PHP","symbol","1.2")),s(4),m("formGroup",e.addToCartForm),s(),m("ngIf",e.quantities&&e.quantities.length)}}function yt(o,r){if(o&1){let e=U();i(0,"div",46)(1,"div",67)(2,"a",48),f("click",function(){_(e);let l=p(2).index,c=p();return C(c.stepDown(l))}),d(3,"i",49),n(),d(4,"input",50),i(5,"a",48),f("click",function(){_(e);let l=p(2).index,c=p();return C(c.stepUp(l))}),d(6,"i",51),n()()()}if(o&2){let e=p(2).index;s(4),q("id",e),m("formControlName",e)}}function xt(o,r){if(o&1){let e=U();i(0,"div",55)(1,"div",56),d(2,"img",57),i(3,"div",58)(4,"div",25)(5,"h5",59),a(6),n(),i(7,"div",60),d(8,"div",61)(9,"div",61)(10,"div",61)(11,"div",61)(12,"div",61),n(),i(13,"p",62)(14,"small",63),a(15),n()(),i(16,"p")(17,"small",63),a(18,"Price:"),n(),a(19),S(20,"currency"),n()()(),i(21,"div",64)(22,"form",65),f("ngSubmit",function(){_(e);let l=p().index,c=p();return C(c.addToCart(l))}),u(23,yt,7,2,"div",45),i(24,"button",66),a(25,"Add to cart"),n()()()()()}if(o&2){let e=p(),t=e.$implicit,l=e.index,c=p();s(2),q("src",c.imageUrls[l]?c.imageUrls[l]:c.itemImageName,V),s(4),v(t.item_name),s(9),y("Quantity: ",t.quantity,""),s(4),y(" ",w(20,6,t.unit_price,"PHP","symbol","1.2")," "),s(3),m("formGroup",c.addToCartForm),s(),m("ngIf",c.quantities&&c.quantities.length)}}function Ot(o,r){if(o&1&&(E(0),u(1,xt,26,11,"div",54),k()),o&2){let e=r.$implicit;s(),m("ngIf",!e.item_name.includes("Bundle"))}}var Ae=class o{constructor(r,e,t,l,c,g){this.router=r;this.fb=e;this.productService=t;this.cartService=l;this.awsS3Service=c;this.authService=g;sessionStorage.getItem("username")&&(this.customerUsername=sessionStorage.getItem("username")),this.isAuthenticated=!!sessionStorage.getItem("username"),this.isAuthenticated&&(this.customerUsername=sessionStorage.getItem("username"),this.authService.getUserByUsername(this.customerUsername).subscribe(x=>{x.length>0&&(this.isDeactivated=x[0].deactivated,console.log(this.isDeactivated),this.isDeactivated&&this.openPromptModal.nativeElement.click())})),console.log(this.isDeactivated),this.products$=this.productService.getProducts().pipe(),this.productService.getProducts().pipe(O(x=>x.filter(M=>M.item_name.includes("Bundle")))).subscribe(x=>{x&&(this.productBundle=x[0])}),this.addToCartForm=this.fb.group({quantities:this.fb.array([])}),this.products$.subscribe(x=>{this.populateQuantities(x)}),console.log(this.quantities),this.groceryCart={username:this.customerUsername,item_img:[],item_name:[],category:[],quantity:[],unit_price:[],subtotal:[]},this.cartItemCount=0,this.getProductBundleIndex(),this.s3Folder="assets/items",this.itemImageName="assets/img/default_item_img.jpg",this.products$.subscribe(x=>{x.forEach(M=>F(this,null,function*(){return this.imageUrls.push(yield this.awsS3Service.getSignedUrl(`${this.s3Folder}/${M.item_img}`))}))})}openPromptModal;products$;productBundle;productBundleIndex;addToCartForm;cartItemCount;customerUsername="";groceryCart;s3Folder;imageUrls=[];itemImageName;isAuthenticated=!1;isDeactivated=!1;ngOnInit(){this.retrieveCustomerCart(this.customerUsername)}get quantities(){return this.addToCartForm.get("quantities")}populateQuantities=r=>{r.forEach(()=>{this.quantities.push(this.fb.control(1,[b.required,b.min(1)]))})};retrieveCustomerCart=r=>{this.cartService.getCartItems(r).subscribe(e=>F(this,null,function*(){e.length>0&&(this.groceryCart=e[0],this.cartItemCount=this.isAuthenticated?e[0].quantity.length:0,console.log("grocery: ",this.groceryCart))}))};logOut=()=>{sessionStorage.clear(),this.router.navigate(["/auth/login"])};getProductBundleIndex=()=>{this.productService.getProducts().pipe(O(r=>{let e=r.findIndex(t=>t.item_name.includes("Bundle"));console.log("bundle: ",e),e===-1?console.log("Error getting index: No product with such name"):this.productBundleIndex=e})).subscribe()};stepUp=r=>{sessionStorage.getItem("username")||this.router.navigate(["/auth/login"]);let e=this.quantities.at(r);this.products$.pipe(O(t=>t[r])).subscribe(t=>{e.value<t.quantity&&e.setValue(e.value+1)})};stepDown=r=>{sessionStorage.getItem("username")||this.router.navigate(["/auth/login"]);let e=this.quantities.at(r);e.value>1&&e.setValue(e.value-1)};addToCart=r=>{sessionStorage.getItem("username")||this.router.navigate(["/auth/login"]),this.isDeactivated?this.openPromptModal.nativeElement.click():parseInt(this.quantities.at(r).value)&&this.products$.pipe(O(e=>e[r])).subscribe(e=>{console.log("product image: ",e.item_img);let t=parseInt(this.quantities.at(r).value);if(console.log("quantity input: ",t),this.groceryCart.id){let l=this.groceryCart.item_name.indexOf(e.item_name);console.log(l),l!==-1?(this.groceryCart.quantity[l]+=t,this.groceryCart.subtotal[l]=this.groceryCart.quantity[l]*this.groceryCart.unit_price[l],this.cartService.updateCustomerCart(this.groceryCart).subscribe(c=>{console.log("Updated customer cart: ",c)},c=>{console.error("Error updating customer cart: ",c)})):(console.log("inside here: ",l),this.groceryCart.item_img.push(e.item_img),this.groceryCart.item_name.push(e.item_name),this.groceryCart.category.push(e.category),this.groceryCart.quantity.push(t),this.groceryCart.unit_price.push(e.unit_price),this.groceryCart.subtotal.push(t*e.unit_price),this.cartService.updateCustomerCart(this.groceryCart).subscribe(c=>{console.log("Updated customer cart: ",c)},c=>{console.error("Error updating customer cart: ",c)}))}else this.groceryCart.username=this.customerUsername,this.groceryCart.item_img.push(e.item_img),this.groceryCart.item_name.push(e.item_name),this.groceryCart.category.push(e.category),this.groceryCart.quantity.push(t),this.groceryCart.unit_price.push(e.unit_price),this.groceryCart.subtotal.push(t*e.unit_price),this.cartService.addCartItem(this.groceryCart).subscribe(l=>{console.log("Added cart item: ",l)},l=>{console.log("Error adding to cart: ",l)}),this.retrieveCustomerCart(this.customerUsername);this.cartItemCount=this.groceryCart.quantity.length,this.quantities.at(r).setValue(1)})};static \u0275fac=function(e){return new(e||o)(h(L),h(Y),h(Ne),h(N),h(Z),h(X))};static \u0275cmp=T({type:o,selectors:[["app-dashboard"]],viewQuery:function(e,t){if(e&1&&ie(Ct,5),e&2){let l;re(l=oe())&&(t.openPromptModal=l.first)}},decls:57,vars:5,consts:[["openPromptModal",""],["closeModalDeactChecked",""],["lang","en"],["charset","utf-8"],["name","viewport","content","width=device-width, initial-scale=1, shrink-to-fit=no"],["name","description","content",""],["name","author","content",""],[3,"itemCountInput"],[1,"py-5"],[1,"container","px-4","px-lg-5","my-5"],["class","front-item gx-4 gx-lg-5 align-items-center",4,"ngIf"],[1,"py-5","bg-light"],[1,"container","px-4","px-lg-5","mt-5"],[1,"fw-bolder","mb-4"],[1,"shop-item","row","gx-4","gx-lg-5","row-cols-2","row-cols-md-3","row-cols-xl-4","justify-content-flex-start"],["type","hidden","data-bs-toggle","modal","data-bs-target","#promptModal"],[4,"ngFor","ngForOf"],["id","promptModal",1,"modal","fade"],[1,"modal-dialog","modal-confirm"],[1,"modal-content"],[1,"modal-header"],[1,"icon-box"],[1,"material-icons"],[1,"modal-title","w-100"],[1,"modal-body"],[1,"text-center"],[1,"modal-footer"],["data-bs-dismiss","modal",1,"btn","btn-danger","w-100"],["id","deactivateSelectedUserModal",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-hidden","true",1,"btn-close"],[1,"text-warning"],["type","button","data-bs-dismiss","modal","value","Cancel",1,"btn","btn-default"],["type","button","value","Understood",1,"btn","btn-danger"],[1,"front-item","gx-4","gx-lg-5","align-items-center"],[1,"front-img","col-md-6"],["alt","...",1,"card-img-top","mb-5","mb-md-0",3,"src"],[1,"col-md-6"],[1,"small","mb-1"],[1,"display-5","fw-bolder"],[1,"fs-5","mb-5"],[1,"text-decoration-line-through"],[1,"lead"],[1,"bundle-form","d-flex",3,"ngSubmit","formGroup"],["formArrayName","quantities",4,"ngIf"],["formArrayName","quantities"],[1,"bundle-qty-wrapper"],[1,"btn","btn-link","px-2",3,"click"],[1,"fa-solid","fa-minus"],["type","number","min","1",1,"form-control","form-control-sm","qty-input",3,"formControlName","id"],[1,"fa-solid","fa-plus"],["type","submit",1,"btn","btn-outline-dark","flex-shrink-0"],[1,"bi-cart-fill","me-1"],["class","item col mb-5",4,"ngIf"],[1,"item","col","mb-5"],[1,"card","h-100"],["alt","...",1,"card-img-top",3,"src"],[1,"card-body","p-4"],[1,"fw-bolder"],[1,"d-flex","justify-content-center","small","text-warning","mb-2"],[1,"bi-star-fill"],[1,"qty"],[1,"text-muted"],[1,"card-footer","p-4","pt-0","border-top-0","bg-transparent"],[1,"text-center",3,"ngSubmit","formGroup"],["type","submit",1,"btn","btn-outline-dark","mt-auto"],[1,"qty-wrapper"]],template:function(e,t){e&1&&(i(0,"html",2)(1,"head"),d(2,"meta",3)(3,"meta",4)(4,"meta",5)(5,"meta",6),i(6,"title"),a(7,"Click"),a(8,"&"),a(9,"Get Convenience Store"),n()(),i(10,"body"),d(11,"app-navbar",7),i(12,"section",8)(13,"div",9),u(14,bt,18,10,"div",10),n()(),i(15,"section",11)(16,"div",12)(17,"h2",13),a(18,"Related products"),n(),i(19,"div",14),d(20,"input",15,0),u(22,Ot,2,1,"ng-container",16),S(23,"async"),n()()(),i(24,"div",17)(25,"div",18)(26,"div",19)(27,"div",20)(28,"div",21)(29,"i",22),a(30,"\uE5CD"),n()(),i(31,"h4",23),a(32,"Sorry!"),n()(),i(33,"div",24)(34,"p",25),a(35,"Your account has been deactivated, \xA0you are unable to add items to cart."),n()(),i(36,"div",26)(37,"button",27),a(38,"Understood"),n()()()()(),i(39,"div",28)(40,"div",29)(41,"div",19)(42,"div",20)(43,"h4",30),a(44,"Deactivate User"),n(),d(45,"button",31,1),n(),i(47,"div",24)(48,"p"),a(49,"Are you sure you want to deactivate these users?"),n(),i(50,"p",32)(51,"small"),a(52,"This action cannot be undone."),n()()(),i(53,"div",26),d(54,"input",33)(55,"input",34),n()()()(),d(56,"app-footer"),n()()),e&2&&(s(11),m("itemCountInput",t.cartItemCount),s(3),m("ngIf",t.productBundle),s(8),m("ngForOf",ae(23,3,t.products$)))},dependencies:[Q,A,ne,Ve,j,D,ke,$,B,Te,K,J,Fe,Pe,H],styles:[".front-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%;width:100%;object-fit:contain}.front-img[_ngcontent-%COMP%]{margin-right:40px;border:2px solid rgba(0,0,0,.351);border-radius:.25rem}.front-item[_ngcontent-%COMP%]{display:flex;flex-direction:row}.item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%;width:100%;max-height:150px;object-fit:contain}.item[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}.item[_ngcontent-%COMP%]   p.qty[_ngcontent-%COMP%]{line-height:1px}.item[_ngcontent-%COMP%]   .qty-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:center;margin-top:-20px;margin-bottom:15px}.item[_ngcontent-%COMP%]   .qty-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:40px;text-align:center}.item[_ngcontent-%COMP%]   .qty-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::-webkit-outer-spin-button, .item[_ngcontent-%COMP%]   .qty-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.bundle-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::-webkit-outer-spin-button, .bundle-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.bundle-form[_ngcontent-%COMP%]   .bundle-qty-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:center;margin-right:1rem}.bundle-form[_ngcontent-%COMP%]   .bundle-qty-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:40px;text-align:center}body[_ngcontent-%COMP%]{font-family:Varela Round,sans-serif}.modal-confirm[_ngcontent-%COMP%]{color:#636363;width:325px}.modal-confirm[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{padding:20px;border-radius:5px;border:none}.modal-confirm[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{border-bottom:none;position:relative}.modal-confirm[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{text-align:center;font-size:26px;margin:30px 0 -15px}.modal-confirm[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%], .modal-confirm[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{min-height:40px;border-radius:3px}.modal-confirm[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{position:absolute;top:-5px;right:-5px}.modal-confirm[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{border:none;text-align:center;border-radius:5px;font-size:13px}.modal-confirm[_ngcontent-%COMP%]   .icon-box[_ngcontent-%COMP%]{color:#fff;position:absolute;margin:0 auto;left:0;right:0;top:-70px;width:95px;height:95px;border-radius:50%;z-index:9;background:#ef513a;padding:15px;text-align:center;box-shadow:0 2px 2px #0000001a}.modal-confirm[_ngcontent-%COMP%]   .icon-box[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:56px;position:relative;top:4px}.modal-confirm.modal-dialog[_ngcontent-%COMP%]{margin-top:80px}.modal-confirm[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{color:#fff;border-radius:4px;background:#ef513a;text-decoration:none;transition:all .4s;line-height:normal;border:none}.modal-confirm[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover, .modal-confirm[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:focus{background:#da2c12;outline:none}.trigger-btn[_ngcontent-%COMP%]{display:inline-block;margin:100px auto}"]})};var pe=o=>({"is-invalid":o});function St(o,r){o&1&&(i(0,"div",53)(1,"a",54),a(2,"Profile"),n(),i(3,"a",15),a(4,"Banks & Cards"),n(),i(5,"a",15),a(6,"Addresses"),n(),i(7,"a",15),a(8,"Change Password"),n(),i(9,"a",15),a(10,"Privacy Settings"),n(),i(11,"a",15),a(12,"Notification Settings"),n()())}function Pt(o,r){o&1&&(i(0,"div"),a(1,"User name is required"),n())}function Mt(o,r){if(o&1&&(i(0,"small",55),u(1,Pt,2,0,"div",50),n()),o&2){let e=p();s(),m("ngIf",e.f.username.errors==null?null:e.f.username.errors.required)}}function wt(o,r){o&1&&(i(0,"small",55),a(1," Username already exists "),n())}function It(o,r){o&1&&(i(0,"div"),a(1,"First name is required"),n())}function Et(o,r){if(o&1&&(i(0,"small",55),u(1,It,2,0,"div",50),n()),o&2){let e=p();s(),m("ngIf",e.f.first_name.errors==null?null:e.f.first_name.errors.required)}}function kt(o,r){o&1&&(i(0,"div"),a(1,"Last name is required"),n())}function Ft(o,r){if(o&1&&(i(0,"small",55),u(1,kt,2,0,"div",50),n()),o&2){let e=p();s(),m("ngIf",e.f.last_name.errors==null?null:e.f.last_name.errors.required)}}function Ut(o,r){o&1&&(i(0,"div"),a(1,"Email is required"),n())}function Tt(o,r){o&1&&(i(0,"div"),a(1,"Email should be valid"),n())}function qt(o,r){if(o&1&&(i(0,"small",55),u(1,Ut,2,0,"div",50)(2,Tt,2,0,"div",50),n()),o&2){let e=p();s(),m("ngIf",e.f.email.errors==null?null:e.f.email.errors.required),s(),m("ngIf",e.f.email.errors==null?null:e.f.email.errors.email)}}function Nt(o,r){o&1&&(i(0,"div"),a(1,"Mobile number is required"),n())}function Vt(o,r){o&1&&(i(0,"div"),a(1,"Mobile number is invalid"),n())}function At(o,r){if(o&1&&(i(0,"small",55),u(1,Nt,2,0,"div",50)(2,Vt,2,0,"div",50),n()),o&2){let e=p();s(),m("ngIf",e.f.mobile_num.errors==null?null:e.f.mobile_num.errors.required),s(),m("ngIf",(e.f.mobile_num.errors==null?null:e.f.mobile_num.errors.pattern)||(e.f.mobile_num.errors==null?null:e.f.mobile_num.errors.maxlength))}}function Lt(o,r){if(o&1&&(E(0),d(1,"img",56),k()),o&2){let e=p();s(),m("src",e.imageUrl,V)}}function Dt(o,r){o&1&&(i(0,"div"),a(1," Item image is required "),n())}function $t(o,r){if(o&1&&(i(0,"small",55),u(1,Dt,2,0,"div",50),n()),o&2){let e=p();s(),m("ngIf",e.f.profile_img.errors==null?null:e.f.profile_img.errors.required)}}var $e=class o{constructor(r,e,t,l,c,g,x,M){this.fb=r;this.authService=e;this.messageService=t;this.usernameValidator=l;this.awsS3Service=c;this.orderService=g;this.cartService=x;this.http=M;this.profileForm=this.fb.group({username:["",b.required],first_name:["",b.required],last_name:["",b.required],email:["",[b.required,b.email]],profile_img:["",b.required],mobile_num:["",[b.required,b.pattern(/^(9)\d{9}/),b.maxLength(10)]]}),this.username=sessionStorage.getItem("username"),this.s3Folder="assets/users",this.profileImgName=this.f.profile_img.value?this.f.profile_img.value:`${this.s3Folder}/default_profile_img-100.png`,this.imageUrl=`${this.s3Folder}/default_profile_img-100.png`,this.savedImageUrl=`${this.s3Folder}/default_profile_img-50.png`,this.timestamp=Date.now().toString(),this.customerName=`${sessionStorage.getItem("first_name")} ${sessionStorage.getItem("last_name")}`,console.log(this.timestamp),this.cartService.getCartItems(this.username).subscribe(I=>{I.length>0&&(this.cartItemCount=I[0].item_name.length)})}isSubMenuVisible=!1;profileForm;username;userExists=!1;submitted=!1;profileImgName;savedProfileImgName;isDefaultImg=!0;selectedFile;imageUrl;savedImageUrl;timestamp;s3Folder;customerName;cartItemCount=0;ngOnInit(){this.authService.getUserByUsername(this.username).subscribe(r=>F(this,null,function*(){if(r.length>0){this.profileForm.patchValue({username:r[0].username}),this.profileForm.patchValue({first_name:r[0].first_name}),this.profileForm.patchValue({last_name:r[0].last_name}),this.profileForm.patchValue({email:r[0].email}),this.profileForm.patchValue({mobile_num:r[0].mobile_num});let e=yield this.awsS3Service.getSignedUrl(`${this.s3Folder}/${r[0].profile_img}`);this.profileImgName=r[0].profile_img?r[0].profile_img:"default_profile_img-100.png",this.imageUrl=e,this.savedImageUrl=e,console.log(r[0].profile_img),this.isDefaultImg=this.profileImgName.includes("default"),this.profileForm.get("username")?.value===this.username&&(this.userExists=!0,console.log("onInit: ",this.userExists))}})),this.profileForm.get("username")?.addAsyncValidators(this.isUsernameTaken())}ngAfterViewChecked(){}get f(){return this.profileForm.controls}get usernameAlreadyTaken(){return this.f.username.hasError("usernameExists")}uploadFile(r){return F(this,null,function*(){let t=r.currentTarget.files;if(t)if(t[0].type.match("image.jpeg")||t[0].type.match("image.jpg")||t[0].type.match("image.png")){this.selectedFile=t[0],this.profileImgName=`${this.f.username.value}-${this.timestamp.slice(0,-3)}.${t[0].type.split("/")[1]}`;try{let l=`assets/users/${this.profileImgName}`;this.imageUrl=yield this.awsS3Service.uploadFile(this.s3Folder,t[0],this.profileImgName),this.imageUrl=yield this.awsS3Service.getSignedUrl(`${this.s3Folder}/${this.profileImgName}`),console.log("File uploaded successfully. Image URL: ",this.imageUrl)}catch(l){console.error("Error uploading file: ",l)}}else this.messageService.add({severity:"error",summary:"Error",detail:"Uploaded file must be an image (JPEG/PNG)"})})}isUsernameUnique=r=>this.userExists?(console.log("isUsernmaeUnique: ",this.userExists),this.usernameValidator.checkIfUsernameUnique(r.value).pipe(O(e=>e?{usernameExists:!0}:null))):et(null);isUsernameTaken=()=>r=>this.usernameValidator.checkIfUsernameUnique(r.value).pipe(O(e=>r.value!==this.username&&e?{usernameExists:!0}:null));toggleSubmenu=()=>{this.isSubMenuVisible=!this.isSubMenuVisible};updateCustomerOrderImage=(r,e)=>{this.orderService.getOrdersByUsername(r).pipe(O(t=>t.filter(l=>l.username.trim().toLowerCase()===r.toLowerCase().trim()))).subscribe(t=>{t.length>0?t.forEach(l=>{l.customer_img=e,console.log(l.customer_img),this.orderService.updateOrder(l).subscribe(c=>{console.log("Updated order img: ",c)},c=>{console.log("Error order update: ",c)})}):console.log("Error updating order image: Customer has no orders")})};onSubmit=()=>{this.submitted=!0;let r=_e({},this.profileForm.getRawValue()),e=Date.now().toString(),t=`${this.f.username.value}-${e.slice(0,-3)}.${this.profileImgName.split(".")[1]}`;this.profileForm.invalid||this.authService.getIdByUsername(this.username).subscribe(l=>{l.length>0&&(r.is_admin=l[0].is_admin,r.password=l[0].password,r.deactivated=l[0].deactivated,r.profile_img=this.profileImgName,console.log("Image name: ",r.profile_img.split(".")[0]),this.customerName=`${r.first_name} ${r.last_name}`,this.authService.updateUser(l[0].id,r).subscribe(c=>F(this,null,function*(){console.log("Updated user: ",c);let g=[];this.savedImageUrl=this.imageUrl,this.updateCustomerOrderImage(r.username,r.profile_img),(yield this.awsS3Service.listObjectsWithName(this.s3Folder)).pipe(O(x=>x?.Contents?.filter(M=>M.Key?.includes(r.username)&&!M.Key?.includes(r.profile_img.split(r.username)[1].split("-")[1].split(".")[0])&&!M.Key?.includes("default")))).subscribe(x=>F(this,null,function*(){g=x.map(M=>M.Key),console.log("Objects containing name: ",g),g.length>0?(yield this.awsS3Service.deleteObjectsWithName(g)).subscribe(M=>{console.log("Deleted objects: ",M.Deleted)},M=>{console.error("Error deleting objects: ",M)}):console.log("Failed object deletion: No objects with such name")}),x=>{console.error("Error listing objects: ",x)}),this.messageService.add({severity:"success",summary:"Success",detail:"Information has been updated"})}),c=>{this.messageService.add({severity:"error",summary:"Error",detail:"Error in updating profile information"})}))})};static \u0275fac=function(e){return new(e||o)(h(Y),h(X),h(ee),h(dt),h(Z),h(te),h(N),h(le))};static \u0275cmp=T({type:o,selectors:[["app-profile"]],decls:103,vars:31,consts:[[3,"itemCountInput"],[1,"container","mt-4","profile-container"],[1,"row"],[1,"col-md-3"],[1,"side-menu"],[1,"small-profile","text-center","mb-4"],["alt","User Avatar",1,"rounded-circle",3,"src"],[1,"mt-2"],[1,"nav","nav-pills","flex-column","mb-auto"],[1,"nav-item"],["id","my-account",1,"nav-link","router-link-active",3,"click"],[1,"bi","bi-person-circle"],["class","submenu",4,"ngIf"],["routerLink","/home/purchases","routerLinkActive","router-link-active",1,"nav-link"],[1,"bi","bi-cart"],["href","#",1,"nav-link"],[1,"bi","bi-bell"],[1,"bi","bi-ticket"],[1,"col-md-9"],[1,"profile-container"],[1,"account-form"],["enctype","multipart/form-data",3,"ngSubmit","formGroup"],[1,"profile-form"],[1,"mb-3"],["for","username",1,"form-label"],["type","text","id","username","formControlName","username","value","johndoe",1,"form-control",3,"ngClass"],[1,"form-text-muted"],["class","invalid-feedback",4,"ngIf"],[1,"fullname","form-group"],["for","firstname",1,"form-label"],["type","text","formControlName","first_name","id","firstname","placeholder","Type your first name",1,"form-control",3,"ngClass"],["for","lastname",1,"form-label"],["type","text","formControlName","last_name","id","lastname","placeholder","Type your last name",1,"form-control",3,"ngClass"],["for","email",1,"form-label"],["type","email","id","email","formControlName","email","placeholder","john.doe@gmail.com",1,"form-control",3,"ngClass"],["for","phone",1,"form-label"],["type","text","id","phone","formControlName","mobile_num","value","********50",1,"form-control",3,"ngClass"],["href","#",1,"form-text"],[1,"form-label"],[1,"form-check","form-check-inline"],["type","radio","name","gender","id","male","value","male",1,"form-check-input"],["for","male",1,"form-check-label"],["type","radio","name","gender","id","female","value","female",1,"form-check-input"],["for","female",1,"form-check-label"],["type","radio","name","gender","id","other","value","other",1,"form-check-input"],["for","other",1,"form-check-label"],["for","dob",1,"form-label"],["type","text","id","dob","value","**/10/19**","disabled","",1,"form-control"],["type","submit",1,"btn","btn-save","btn-primary"],[1,"profile-image"],[4,"ngIf"],["type","file","name","","id","profile-img-input","placeholder","Choose an image","accept","image/png, image/jpeg","formControlName","profile_img",1,"form-control",3,"change","ngClass"],[1,"form-text-muted","d-block","mt-2"],[1,"submenu"],["routerLink","/home/profile","routerLinkActive","router-link-active",1,"nav-link"],[1,"invalid-feedback"],["alt","Profile Image",3,"src"]],template:function(e,t){e&1&&(i(0,"section"),d(1,"app-navbar",0),i(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5),d(7,"img",6),i(8,"p",7),a(9),n()(),d(10,"hr"),i(11,"ul",8)(12,"li",9)(13,"a",10),f("click",function(){return t.toggleSubmenu()}),d(14,"i",11),a(15," My Account "),n(),u(16,St,13,0,"div",12),n(),i(17,"li")(18,"a",13),d(19,"i",14),a(20," My Purchases "),n()(),i(21,"li")(22,"a",15),d(23,"i",16),a(24," Notifications "),n()(),i(25,"li")(26,"a",15),d(27,"i",17),a(28," My Vouchers "),n()()()()(),i(29,"div",18)(30,"div",19)(31,"h4"),a(32,"My Profile"),n(),i(33,"p"),a(34,"Manage and protect your account"),n(),d(35,"hr"),i(36,"div",20)(37,"form",21),f("ngSubmit",function(){return t.onSubmit()}),i(38,"div",22)(39,"div",23)(40,"label",24),a(41,"Username"),n(),d(42,"input",25),i(43,"small",26),a(44,"Username can only be changed once."),n(),u(45,Mt,2,1,"small",27)(46,wt,2,0,"small",27),n(),i(47,"div",28)(48,"div",23)(49,"label",29),a(50,"First Name"),n(),d(51,"input",30),u(52,Et,2,1,"small",27),n(),i(53,"div",23)(54,"label",31),a(55,"Last Name"),n(),d(56,"input",32),u(57,Ft,2,1,"small",27),n()(),i(58,"div",23)(59,"label",33),a(60,"Email"),n(),d(61,"input",34),u(62,qt,3,2,"small",27),n(),i(63,"div",23)(64,"label",35),a(65,"Phone Number"),n(),d(66,"input",36),i(67,"a",37),a(68,"Change"),n(),u(69,At,3,2,"small",27),n(),i(70,"div",23)(71,"label",38),a(72,"Gender"),n(),i(73,"div")(74,"div",39),d(75,"input",40),i(76,"label",41),a(77,"Male"),n()(),i(78,"div",39),d(79,"input",42),i(80,"label",43),a(81,"Female"),n()(),i(82,"div",39),d(83,"input",44),i(84,"label",45),a(85,"Other"),n()()()(),i(86,"div",23)(87,"label",46),a(88,"Date of Birth"),n(),d(89,"input",47),i(90,"small",26),a(91,"You have already done KYC. Changing your birthday is not permitted."),n()(),i(92,"button",48),a(93," Save "),n()(),i(94,"div",49),u(95,Lt,2,1,"ng-container",50),d(96,"br"),i(97,"input",51),f("change",function(c){return t.uploadFile(c)}),n(),u(98,$t,2,1,"small",27),i(99,"small",52),a(100,"File size: maximum 1 MB"),n(),i(101,"small",26),a(102,"File extension: .JPEG, .PNG"),n()()()()()()()()()),e&2&&(s(),m("itemCountInput",t.cartItemCount),s(6),q("src",t.savedImageUrl,V),s(2),v(t.customerName),s(7),m("ngIf",t.isSubMenuVisible),s(21),m("formGroup",t.profileForm),s(5),m("ngClass",P(19,pe,t.submitted&&t.f.username.errors||t.usernameAlreadyTaken&&t.f.username.touched)),s(3),m("ngIf",t.f.username.invalid&&(t.f.username.dirty||t.f.username.touched)),s(),m("ngIf",t.usernameAlreadyTaken),s(5),m("ngClass",P(21,pe,t.submitted&&t.f.first_name.errors)),s(),m("ngIf",t.f.first_name.invalid&&(t.f.first_name.dirty||t.f.last_name.touched)),s(4),m("ngClass",P(23,pe,t.submitted&&t.f.last_name.errors)),s(),m("ngIf",t.f.last_name.invalid&&(t.f.last_name.dirty||t.f.last_name.touched)),s(4),m("ngClass",P(25,pe,t.submitted&&t.f.email.errors)),s(),m("ngIf",t.f.email.invalid&&(t.f.email.dirty||t.f.email.touched)),s(4),m("ngClass",P(27,pe,t.submitted&&t.f.mobile_num.errors||t.f.mobile_num.touched&&((t.f.mobile_num.errors==null?null:t.f.mobile_num.errors.pattern)||(t.f.mobile_num.errors==null?null:t.f.mobile_num.errors.maxlength)))),s(3),m("ngIf",t.f.mobile_num.invalid&&(t.f.mobile_num.dirty||t.f.mobile_num.touched)),s(26),m("ngIf",t.imageUrl),s(2),m("ngClass",P(29,pe,t.submitted&&t.isDefaultImg&&!t.f.profile_img.value)),s(),m("ngIf",t.isDefaultImg&&t.submitted))},dependencies:[G,A,W,se,ne,j,D,$,B,K,J],styles:["section[_ngcontent-%COMP%]{background-color:#f5f5f5}.profile-container[_ngcontent-%COMP%]{background-color:#fff;padding:20px;border-radius:5px;box-shadow:0 0 10px #0000001a}.side-menu[_ngcontent-%COMP%]{background-color:#fff;padding:20px;border-radius:5px;box-shadow:0 0 10px #0000001a;height:100%}.side-menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#000;text-decoration:none;display:block;padding:10px 0;border-bottom:1px solid #f1f1f1}.side-menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .side-menu[_ngcontent-%COMP%]   a.router-link-active[_ngcontent-%COMP%]{color:#2c3ce980}.side-menu[_ngcontent-%COMP%]   .submenu[_ngcontent-%COMP%]{padding-left:20px}.side-menu[_ngcontent-%COMP%]   .submenu[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{padding-left:30px}.side-menu[_ngcontent-%COMP%]   #my-account[_ngcontent-%COMP%]{cursor:pointer}.dropdown-container[_ngcontent-%COMP%]{display:none;padding-left:15px}.account-form[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-around}.profile-form[_ngcontent-%COMP%]{width:100%;padding:0 20px;max-width:700px}.form-control.is-invalid[_ngcontent-%COMP%]{border-color:#dc3545}.invalid-feedback[_ngcontent-%COMP%]{color:#dc3545;font-size:.875rem}.fullname[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.fullname[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100%}.fullname[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-child{margin-right:20px}.btn-save[_ngcontent-%COMP%]{border:none}.profile-image[_ngcontent-%COMP%]{text-align:center;margin-top:150px;max-width:300px;width:100%}.profile-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:150px;height:150px;border-radius:50%;object-fit:cover;border:2px solid #e9ecef}.profile-image[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:10px}.form-text-muted[_ngcontent-%COMP%]{color:#6c757d;font-size:12px}#profile-img-input[_ngcontent-%COMP%]{margin:15px auto 5px;width:250px}.small-profile[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:90px;height:90px;border-radius:50%;object-fit:cover;border:2px solid #e9ecef}.small-profile[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:20px}"]})};var Bt=["openPromptModal"],jt=o=>({"is-invalid":o});function zt(o,r){if(o&1&&(i(0,"div",50),a(1),n()),o&2){let e=p();s(),y("",e.filteredItems.item_name.length," items")}}function Rt(o,r){o&1&&(i(0,"div",51),a(1," No items in your cart "),n())}function Gt(o,r){if(o&1){let e=U();E(0,61),i(1,"div",62)(2,"a",63),f("click",function(){_(e);let l=p().index,c=p(2);return C(c.decreaseQuantity(l))}),d(3,"i",64),n(),d(4,"input",65),i(5,"a",63),f("click",function(){_(e);let l=p().index,c=p(2);return C(c.increaseQuantity(l))}),d(6,"i",66),n()(),k()}if(o&2){let e=p().index;s(4),q("id",e),m("formControlName",e)}}function Qt(o,r){if(o&1){let e=U();E(0),i(1,"div",53)(2,"div",54)(3,"div",55),d(4,"img",56),n(),i(5,"div",4)(6,"div",57),a(7),n(),i(8,"div",14),a(9),n()(),i(10,"div",55),u(11,Gt,7,2,"ng-container",58),n(),i(12,"div",55),a(13),S(14,"currency"),n(),i(15,"div",59)(16,"a",60),f("click",function(){let l=_(e).index,c=p(2);return C(c.removeItem(l))}),a(17,"\u2715"),n()()()(),k()}if(o&2){let e=r.$implicit,t=r.index,l=p(2);s(4),q("src",l.imageUrls[t],V),s(3),v(l.filteredItems.category[t]),s(2),v(e),s(2),m("ngIf",l.quantities&&l.quantities.length),s(2),y(" ",w(14,5,l.filteredItems.subtotal[t],"PHP","symbol","1.2"),"")}}function Ht(o,r){if(o&1&&(i(0,"div"),u(1,Qt,18,10,"ng-container",52),n()),o&2){let e=p();s(),m("ngForOf",e.filteredItems.item_name)}}function Wt(o,r){if(o&1&&(i(0,"div",67),a(1),n()),o&2){let e=p();s(),y("",e.filteredItems.item_name.length," ITEMS")}}function Kt(o,r){if(o&1&&(i(0,"div",68),a(1),S(2,"currency"),n()),o&2){let e=p();s(),v(w(2,1,e.getTotal(),"PHP","symbol","1.2"))}}function Jt(o,r){if(o&1&&(i(0,"option",69),a(1),n()),o&2){let e=r.$implicit;m("value",e),s(),y(" ",e," ")}}function Yt(o,r){o&1&&(i(0,"small",70),a(1," Select a fulfillment method "),n())}function Zt(o,r){if(o&1&&(i(0,"div",68),a(1),S(2,"currency"),n()),o&2){let e=p();s(),v(w(2,1,e.getTotal(),"PHP","symbol","1.2"))}}var Be=class o{constructor(r,e,t,l,c,g,x,M){this.fb=r;this.awsS3Service=e;this.messageService=t;this.productService=l;this.cartService=c;this.authService=g;this.orderService=x;this.router=M;sessionStorage.getItem("username")&&(this.customerUsername=sessionStorage.getItem("username")),this.isAuthenticated=!!sessionStorage.getItem("username"),this.isAuthenticated&&(this.customerUsername=sessionStorage.getItem("username"),this.authService.getUserByUsername(this.customerUsername).subscribe(I=>{I.length>0&&(this.isDeactivated=I[0].deactivated,this.isDeactivated)})),this.cartService.getCartItems(this.customerUsername).subscribe(I=>{I.length>0&&(this.groceryCartLength=I[0].quantity.length?I[0].quantity.length:0)}),this.cartItems$=this.cartService.getCartItems(this.customerUsername),this.authService.getUserByUsername(this.customerUsername).subscribe(I=>{I.length>0&&(this.customerImage=I[0].profile_img)}),this.s3Folder="assets/items",this.groceryCart={id:"",username:this.customerUsername,item_img:[],item_name:[],category:[],quantity:[],unit_price:[],subtotal:[]},this.filteredItems=this.groceryCart,this.checkoutForm=this.fb.group({quantities:this.fb.array([]),fulfillmentMethod:["Select fulfillment method",b.required]}),this.groceryCartLength>0&&this.cartItems$.subscribe(I=>{this.groceryCart=I[0],this.groceryCart.id=I[0].id,this.groceryCartLength=this.groceryCart.item_name.length,this.filteredItems=this.groceryCart,console.log("grocery: ",this.groceryCart),I[0].item_img.forEach(ft=>F(this,null,function*(){this.imageUrls.push(`${this.awsS3Service.cloudfrontDomain}/${this.s3Folder}/${ft}`)})),this.populateQuantities(I[0].quantity)}),this.searchQuery="",this.searchCart(),this.fulfillmentMethods=["Pick Up","Delivery"]}openPromptModal;selectAll=!1;submitted=!1;cartItems$;groceryCart;groceryCartLength=0;customerUsername="";checkoutForm;searchQuery="";filteredItems;fulfillmentMethods=[];customerImage="";isAuthenticated=!1;isDeactivated=!1;timestamp=Date.now();s3Folder;imageUrls=[];ngOnInit(){this.retrieveCustomerCart(this.customerUsername)}get f(){return this.checkoutForm.controls}get quantities(){return this.checkoutForm.get("quantities")}populateQuantities=r=>{r.forEach(e=>{this.quantities.push(this.fb.control(1,[b.required,b.min(1)]))})};searchCart=()=>{this.searchQuery?this.cartService.getCartItems(this.customerUsername).pipe(O(r=>r.map(e=>{let t=e.item_name.map((l,c)=>l.toLowerCase().includes(this.searchQuery.toLowerCase())||e.category[c].includes(this.searchQuery)?c:-1).filter(l=>l!==-1);return Xe(_e({},e),{item_img:t.map(l=>e.item_img[l]),item_name:t.map(l=>e.item_name[l]),category:t.map(l=>e.category[l]),quantity:t.map(l=>e.quantity[l]),unit_price:t.map(l=>e.unit_price[l]),subtotal:t.map(l=>e.subtotal[l])})}))).subscribe(r=>{console.log("filtered carts: ",r),this.filteredItems=r[0],this.quantities.clear(),this.populateQuantities(this.filteredItems.quantity),console.log("quantities: ",this.quantities.length),this.retrieveCustomerCart(this.customerUsername),this.imageUrls=[],r[0].item_img.forEach(e=>{this.imageUrls.push(`${this.awsS3Service.cloudfrontDomain}/${this.s3Folder}/${e}`)})}):this.cartService.getCartItems(this.customerUsername).subscribe(r=>{r.length>0&&(this.filteredItems=r[0],this.filteredItems.id=r[0].id,this.quantities.clear(),this.populateQuantities(this.filteredItems.quantity),this.retrieveCustomerCart(this.customerUsername),this.imageUrls=[],r[0].item_img.forEach(e=>{this.imageUrls.push(`${this.awsS3Service.cloudfrontDomain}/${this.s3Folder}/${e}`)}))})};removeAllQuantities=()=>{console.log(this.checkoutForm.get("quantity").length)};retrieveCustomerCart=(r,e=null)=>{this.cartService.getCartItems(r).subscribe(t=>F(this,null,function*(){if(t.length>0)if(this.groceryCart=t[0],this.groceryCart.id=t[0].id,this.groceryCartLength=this.groceryCart.item_name.length,console.log("grocery: ",this.groceryCart),t.forEach(l=>F(this,null,function*(){this.imageUrls.push(yield this.awsS3Service.getSignedUrl(`${this.s3Folder}/${l.item_img}`))})),console.log("quantities length (retrieved): ",e),e)for(let l=0;l<t[0].quantity.length;l++)l!==e&&this.quantities.at(l).setValue(t[0].quantity[l]);else for(let l=0;l<t[0].quantity.length;l++)this.quantities.at(l).setValue(t[0].quantity[l])}))};decreaseQuantity(r){let e=this.quantities.at(r);if(this.isDeactivated)this.openPromptModal.nativeElement.click();else if(e.value>1){e.setValue(e.value-1),this.filteredItems.quantity[r]-=1,this.filteredItems.subtotal[r]=e.value*this.groceryCart.unit_price[r];let t=this.groceryCart.item_name.indexOf(this.filteredItems.item_name[r]);console.log("cart: ",this.groceryCart.item_name[t]),this.groceryCart.quantity[t]-=1,this.groceryCart.subtotal[t]=e.value*this.groceryCart.unit_price[t],this.updateCustomerGroceryCart(this.groceryCart,null,!1)}}increaseQuantity(r){let e=this.quantities.at(r);this.isDeactivated?this.openPromptModal.nativeElement.click():this.productService.getProducts().pipe(O(t=>t.filter(l=>l.item_name.includes(this.groceryCart.item_name[r])))).subscribe(t=>{if(console.log(t),e.value<t[0].quantity){e.setValue(e.value+1),this.filteredItems.quantity[r]+=1,this.filteredItems.subtotal[r]=e.value*this.filteredItems.unit_price[r];let l=this.groceryCart.item_name.indexOf(this.filteredItems.item_name[r]);console.log("cart: ",this.groceryCart.item_name[l]),this.groceryCart.quantity[l]+=1,this.groceryCart.subtotal[l]=e.value*this.groceryCart.unit_price[l],this.updateCustomerGroceryCart(this.groceryCart,null,!1)}})}removeItem(r){if(this.isDeactivated)this.openPromptModal.nativeElement.click();else{let e=this.filteredItems.item_name[r];this.filteredItems.item_img.splice(r,1),this.filteredItems.item_name.splice(r,1),this.filteredItems.category.splice(r,1),this.filteredItems.quantity.splice(r,1),this.filteredItems.unit_price.splice(r,1),this.filteredItems.subtotal.splice(r,1);let t=this.groceryCart.item_name.indexOf(e);console.log("cart: ",this.groceryCart.item_name[t]),this.groceryCart.item_img.splice(t,1),this.groceryCart.item_name.splice(t,1),this.groceryCart.category.splice(t,1),this.groceryCart.quantity.splice(t,1),this.groceryCart.unit_price.splice(t,1),this.groceryCart.subtotal.splice(t,1),this.updateCustomerGroceryCart(this.groceryCart,e,!0),this.imageUrls.splice(r,1),console.log("quantities length: ",this.quantities.length),this.quantities.removeAt(r),console.log("quantities length: ",this.quantities.length),this.retrieveCustomerCart(this.customerUsername,r)}}updateCustomerGroceryCart=(r,e,t=!1)=>{this.cartService.updateCustomerCart(r).subscribe(l=>{console.log("Updated/Removed cart item: ",l),t&&this.messageService.add({severity:"success",summary:"Success",detail:`${e} has been removed from your cart.`})},l=>{console.log("Failed to update cart item: ",l),t&&this.messageService.add({severity:"error",summary:"Error",detail:"Failed to remove cart item"})})};getTotal(){return this.filteredItems.subtotal.reduce((r,e)=>r+e,0)}onCheckout=()=>{this.submitted=!0;let r=this.checkoutForm.get("fulfillmentMethod")?.value;if(this.isDeactivated)this.openPromptModal.nativeElement.click();else{if(this.groceryCartLength<1){this.messageService.add({severity:"error",summary:"Error",detail:"No items in your cart to checkout"});return}if(this.checkoutForm.invalid||r.startsWith("Select"))return;console.log("cart onCheckout: ",this.groceryCart),console.log("customer image: ",this.customerImage);let e={username:this.customerUsername,customer_img:this.customerImage,customer:`${sessionStorage.getItem("first_name")} ${sessionStorage.getItem("last_name")}`,location:"",datetime:Date.now(),item_name:this.groceryCart.item_name,category:this.groceryCart.category,payment_mode:"COD",quantity:this.groceryCart.quantity,subtotal:this.groceryCart.subtotal,status:"Pending"};console.log("Order: ",e),this.orderService.getTempOrders().subscribe(t=>{if(t.length>0)if(t.some(l=>l.username.toLowerCase()===this.customerUsername.toLowerCase())){let l=t.find(c=>c.username.toLowerCase()===this.customerUsername.toLowerCase());this.orderService.updateTempOrder(l).subscribe(c=>{console.log("Order has been updated: ",c),this.router.navigate(["/home/checkout"])},c=>{console.log("Failed to update order: ",c)})}else this.orderService.createTempOrder(e).subscribe(l=>{console.log("Order has been created: ",l),this.router.navigate(["/home/checkout"])},l=>{console.log("Failed to created order: ",l)});else this.orderService.createTempOrder(e).subscribe(l=>{console.log("Order has been created: ",l),this.router.navigate(["/home/checkout"])},l=>{console.log("Failed to created order: ",l)})})}};static \u0275fac=function(e){return new(e||o)(h(Y),h(Z),h(ee),h(Ne),h(N),h(X),h(te),h(L))};static \u0275cmp=T({type:o,selectors:[["app-cart"]],viewQuery:function(e,t){if(e&1&&ie(Bt,5),e&2){let l;re(l=oe())&&(t.openPromptModal=l.first)}},decls:83,vars:13,consts:[["openPromptModal",""],[1,"container-fluid","p-0"],[1,"container","py-5"],[1,"row","mb-4"],[1,"col"],[1,"fw-bold"],[1,"col-md-3"],[1,"d-flex"],["type","search","placeholder","Search for products","aria-label","Search",1,"form-control","me-2",3,"ngModelChange","keyup","ngModel"],["type","submit",1,"btn","btn-outline-success"],[1,"card"],[1,"row",3,"ngSubmit","formGroup"],[1,"col-md-8","cart"],[1,"title"],[1,"row"],["class","col-sm-2 align-self-center text-right text-muted",4,"ngIf"],[1,"cart-items"],[1,"row","border-top"],[1,"row","main","align-items-center","thead"],[1,"col-5"],["class","text-center no-items m-4",4,"ngIf"],[4,"ngIf"],[1,"back-to-shop"],["routerLink","/home"],[1,"fa-solid","fa-left-long"],[1,"text-muted"],[1,"col-md-4","summary"],["class","col","style","padding-left:0;",4,"ngIf"],["class","col text-right",4,"ngIf"],[1,"formgroup"],[1,"mb-4"],["formControlName","fulfillmentMethod",3,"ngClass"],["selected",""],[3,"value",4,"ngFor","ngForOf"],["class","invalid-feedback",4,"ngIf"],["type","text","id","code","placeholder","Enter your code"],[1,"row",2,"border-top","1px solid rgba(0,0,0,.1)","padding","2vh 0"],["type","submit"],["type","hidden","data-bs-toggle","modal","data-bs-target","#promptModal"],["id","promptModal",1,"modal","fade"],[1,"modal-dialog","modal-confirm"],[1,"modal-content"],[1,"modal-header"],[1,"icon-box"],[1,"material-icons"],[1,"modal-title","w-100"],[1,"modal-body"],[1,"text-center"],[1,"modal-footer"],["data-bs-dismiss","modal",1,"btn","btn-danger","w-100"],[1,"col-sm-2","align-self-center","text-right","text-muted"],[1,"text-center","no-items","m-4"],[4,"ngFor","ngForOf"],[1,"cart-item-group","row","border-top","border-bottom"],[1,"row","main","align-items-center","tbody"],[1,"col-2"],[1,"img-fluid",3,"src"],[1,"category","row","text-muted"],["formArrayName","quantities",4,"ngIf"],[1,"col-sm-1"],[1,"close",3,"click"],["formArrayName","quantities"],[1,"qty-wrapper"],[1,"btn","btn-link","px-2",3,"click"],[1,"fa-solid","fa-minus"],["type","number","min","1",1,"form-control","form-control-sm","qty-input",3,"id","formControlName"],[1,"fa-solid","fa-plus"],[1,"col",2,"padding-left","0"],[1,"col","text-right"],[3,"value"],[1,"invalid-feedback"]],template:function(e,t){if(e&1){let l=U();i(0,"section",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"h2",5),a(5,"Grocery Cart"),n()(),i(6,"div",6)(7,"div",7)(8,"input",8),Se("ngModelChange",function(g){return _(l),Oe(t.searchQuery,g)||(t.searchQuery=g),C(g)}),f("keyup",function(){return _(l),C(t.searchCart())}),n(),i(9,"button",9),a(10," Search "),n()()()(),i(11,"div",10)(12,"form",11),f("ngSubmit",function(){return _(l),C(t.onCheckout())}),i(13,"div",12)(14,"div",13)(15,"div",14)(16,"div",4)(17,"h4")(18,"b"),a(19,"Grocery Cart Items"),n()()(),u(20,zt,2,1,"div",15),n()(),i(21,"div",16)(22,"div",17)(23,"div",18)(24,"div",19),a(25,"Product"),n(),i(26,"div",4),a(27,"Quantity"),n(),i(28,"div",4),a(29,"Subtotal"),n(),i(30,"div",4),a(31,"Actions"),n()()(),u(32,Rt,2,0,"div",20)(33,Ht,2,1,"div",21),n(),i(34,"div",22)(35,"a",23),d(36,"i",24),n(),i(37,"span",25),a(38,"Back to shop"),n()()(),i(39,"div",26)(40,"div")(41,"h5")(42,"b"),a(43,"Summary"),n()()(),d(44,"hr"),i(45,"div",14),u(46,Wt,2,1,"div",27)(47,Kt,3,6,"div",28),n(),i(48,"div",29)(49,"div",30)(50,"p"),a(51,"Fulfillment Method"),n(),i(52,"select",31)(53,"option",32),a(54,"Select fulfillment method"),n(),u(55,Jt,2,2,"option",33),n(),u(56,Yt,2,0,"small",34),n(),i(57,"p"),a(58,"Voucher"),n(),d(59,"input",35),n(),i(60,"div",36)(61,"div",4),a(62,"TOTAL PRICE"),n(),u(63,Zt,3,6,"div",28),n(),i(64,"button",37),a(65,"CHECKOUT"),n()()()()()(),d(66,"input",38,0),i(68,"div",39)(69,"div",40)(70,"div",41)(71,"div",42)(72,"div",43)(73,"i",44),a(74,"\uE5CD"),n()(),i(75,"h4",45),a(76,"Sorry!"),n()(),i(77,"div",46)(78,"p",47),a(79,"Your account has been deactivated, \xA0you are unable to perform this operation."),n()(),i(80,"div",48)(81,"button",49),a(82,"Understood"),n()()()()()}e&2&&(s(8),xe("ngModel",t.searchQuery),s(4),m("formGroup",t.checkoutForm),s(8),m("ngIf",t.filteredItems&&t.filteredItems.item_name.length),s(12),m("ngIf",t.groceryCartLength<1),s(),m("ngIf",t.filteredItems&&t.filteredItems.item_name.length),s(13),m("ngIf",t.filteredItems),s(),m("ngIf",t.filteredItems),s(5),m("ngClass",P(11,jt,t.submitted&&t.f.fulfillmentMethod.value==="Select fulfillment method")),s(3),m("ngForOf",t.fulfillmentMethods),s(),m("ngIf",t.f.fulfillmentMethod.value==="Select fulfillment method"&&t.submitted),s(7),m("ngIf",t.filteredItems))},dependencies:[G,Q,A,W,j,me,ce,D,ke,Ue,$,B,Te,K,J,Fe,Ee,H],styles:["section[_ngcontent-%COMP%]{height:100%;background-color:#f5f5f5}img.img-thumbnail[_ngcontent-%COMP%]{width:60px;height:auto}h6[_ngcontent-%COMP%]{margin-bottom:0}.td-item[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-between;align-items:center;width:108%}.td-item-name[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:25px}.td-item-info[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-around;align-items:center}.td-item-info[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button, .td-item-info[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.td-item-info[_ngcontent-%COMP%]   .td-item-price[_ngcontent-%COMP%]{text-align:center}body[_ngcontent-%COMP%]{background:#ddd;min-height:100vh;vertical-align:middle;display:flex;font-family:sans-serif;font-size:.8rem;font-weight:700}.title[_ngcontent-%COMP%]{margin-bottom:5vh}.card[_ngcontent-%COMP%]{margin:auto;max-width:1250px;width:100%;box-shadow:0 6px 20px #00000030;border-radius:1rem;border:transparent;min-height:400px}@media (max-width: 767px){.card[_ngcontent-%COMP%]{margin:3vh auto}}.cart[_ngcontent-%COMP%]{background-color:#fff;padding:4vh 5vh;border-bottom-left-radius:1rem;border-top-left-radius:1rem}@media (max-width: 767px){.cart[_ngcontent-%COMP%]{padding:4vh;border-bottom-left-radius:unset;border-top-right-radius:1rem}}.summary[_ngcontent-%COMP%]{background-color:#ddd;border-top-right-radius:1rem;border-bottom-right-radius:1rem;padding:4vh;color:#414141}@media (max-width: 767px){.summary[_ngcontent-%COMP%]{border-top-right-radius:unset;border-bottom-left-radius:1rem}}.summary[_ngcontent-%COMP%]   .col-2[_ngcontent-%COMP%], .summary[_ngcontent-%COMP%]   .col-10[_ngcontent-%COMP%]{padding:0}.row[_ngcontent-%COMP%]{margin:0}.title[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{font-size:1.5rem}.main[_ngcontent-%COMP%]{margin:0;padding:2vh 0;width:100%}.col-2[_ngcontent-%COMP%], .col[_ngcontent-%COMP%], a[_ngcontent-%COMP%]{padding:0 1vh}.close[_ngcontent-%COMP%]{all:none;text-decoration:unset;margin-left:auto;font-size:1rem;font-weight:700;color:red;cursor:pointer}.close[_ngcontent-%COMP%]:hover{color:#b20606}img[_ngcontent-%COMP%]{width:3.5rem}.back-to-shop[_ngcontent-%COMP%]{padding-top:1.5rem}h5[_ngcontent-%COMP%]{margin-top:4vh}hr[_ngcontent-%COMP%]{margin-top:1.25rem}.formgroup[_ngcontent-%COMP%]{padding:2vh 0}select[_ngcontent-%COMP%]{border:1px solid rgba(0,0,0,.137);padding:1.5vh 1vw;outline:none;width:100%;background-color:#f7f7f7;cursor:pointer}select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{cursor:pointer}.card[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{border:1px solid rgba(0,0,0,.137);padding:1vh;margin-bottom:4vh;outline:none;width:100%;background-color:#f7f7f7}input[_ngcontent-%COMP%]:focus::-webkit-input-placeholder{color:transparent}.card[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#000;border-color:#000;color:#fff;width:100%;font-size:.7rem;margin-top:4vh;padding:1vh;border-radius:0}button.btn[_ngcontent-%COMP%]:focus{outline:none;box-shadow:none;color:#fff;-webkit-box-shadow:none;-webkit-user-select:none;transition:none}button.btn[_ngcontent-%COMP%]:hover{color:#fff}a[_ngcontent-%COMP%]{color:#000}a[_ngcontent-%COMP%]:hover{color:#000;text-decoration:none}#code[_ngcontent-%COMP%]{background-image:linear-gradient(to left,#ffffff41,#ffffff2f),url(https://img.icons8.com/small/16/000000/long-arrow-right.png);background-repeat:no-repeat;background-position-x:95%;background-position-y:center}.cart-items[_ngcontent-%COMP%]{overflow-y:auto;height:100%;height:400px}.category[_ngcontent-%COMP%]{font-size:15px}.thead[_ngcontent-%COMP%]{font-weight:700}.thead[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-child{text-align:center;margin-right:8rem}.thead[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(2){margin-right:2rem}.thead[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(3){margin-right:2rem}.card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .qty-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;align-items:center;vertical-align:middle;margin-left:-13px}.card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .qty-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:35px;height:30px;text-align:center}.qty-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::-webkit-outer-spin-button, .qty-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.is-invalid[_ngcontent-%COMP%]{border-color:#dc3545}.invalid-feedback[_ngcontent-%COMP%]{color:#dc3545;font-size:.875rem}.modal-confirm[_ngcontent-%COMP%]{color:#636363;width:325px}.modal-confirm[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{padding:20px;border-radius:5px;border:none}.modal-confirm[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{border-bottom:none;position:relative}.modal-confirm[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{text-align:center;font-size:26px;margin:30px 0 -15px}.modal-confirm[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%], .modal-confirm[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{min-height:40px;border-radius:3px}.modal-confirm[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{position:absolute;top:-5px;right:-5px}.modal-confirm[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{border:none;text-align:center;border-radius:5px;font-size:13px}.modal-confirm[_ngcontent-%COMP%]   .icon-box[_ngcontent-%COMP%]{color:#fff;position:absolute;margin:0 auto;left:0;right:0;top:-70px;width:95px;height:95px;border-radius:50%;z-index:9;background:#ef513a;padding:15px;text-align:center;box-shadow:0 2px 2px #0000001a}.modal-confirm[_ngcontent-%COMP%]   .icon-box[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:56px;position:relative;top:4px}.modal-confirm.modal-dialog[_ngcontent-%COMP%]{margin-top:80px}.modal-confirm[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{color:#fff;border-radius:4px;background:#ef513a;text-decoration:none;transition:all .4s;line-height:normal;border:none}.modal-confirm[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover, .modal-confirm[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:focus{background:#da2c12;outline:none}.trigger-btn[_ngcontent-%COMP%]{display:inline-block;margin:100px auto}"]})};var je=class o{constructor(r){this.http=r}serverUrl=qe.SERVER_URL;checkIfUserAddressExists=r=>this.getAddresses().pipe(O(t=>t.some(l=>l.username.toLowerCase()===r.toLowerCase())));getAddresses=()=>this.http.get(`${this.serverUrl}/addresses`);addUserAddress=r=>this.http.post(`${this.serverUrl}/addresses`,r);getAddressByUsername=r=>this.http.get(`${this.serverUrl}/addresses?username=${r}`);updateUserAddress=r=>this.http.put(`${this.serverUrl}/addresses/${r.id}`,r);static \u0275fac=function(e){return new(e||o)(be(le))};static \u0275prov=Ce({token:o,factory:o.\u0275fac,providedIn:"root"})};var en=["openReceiptModal"],tn=["closeReceiptModal"],R=o=>({"is-invalid":o});function nn(o,r){o&1&&(i(0,"div"),a(1,"First name is required"),n())}function rn(o,r){if(o&1&&(i(0,"small",78),u(1,nn,2,0,"div",70),n()),o&2){let e=p();s(),m("ngIf",e.addForm.first_name.errors==null?null:e.addForm.first_name.errors.required)}}function on(o,r){o&1&&(i(0,"div"),a(1,"Last name is required"),n())}function an(o,r){if(o&1&&(i(0,"small",78),u(1,on,2,0,"div",70),n()),o&2){let e=p();s(),m("ngIf",e.addForm.last_name.errors==null?null:e.addForm.last_name.errors.required)}}function ln(o,r){o&1&&(i(0,"div"),a(1,"Email is required"),n())}function sn(o,r){o&1&&(i(0,"div"),a(1,"Email should be valid"),n())}function mn(o,r){if(o&1&&(i(0,"small",78),u(1,ln,2,0,"div",70)(2,sn,2,0,"div",70),n()),o&2){let e=p();s(),m("ngIf",e.addForm.email.errors==null?null:e.addForm.email.errors.required),s(),m("ngIf",e.addForm.email.errors==null?null:e.addForm.email.errors.email)}}function cn(o,r){o&1&&(i(0,"div"),a(1,"Mobile number is required"),n())}function dn(o,r){o&1&&(i(0,"div"),a(1,"Mobile number is invalid"),n())}function pn(o,r){if(o&1&&(i(0,"small",78),u(1,cn,2,0,"div",70)(2,dn,2,0,"div",70),n()),o&2){let e=p();s(),m("ngIf",e.addForm.mobile_num.errors==null?null:e.addForm.mobile_num.errors.required),s(),m("ngIf",(e.addForm.mobile_num.errors==null?null:e.addForm.mobile_num.errors.pattern)||(e.addForm.mobile_num.errors==null?null:e.addForm.mobile_num.errors.maxlength))}}function un(o,r){o&1&&(i(0,"div"),a(1,"User name is required"),n())}function gn(o,r){if(o&1&&(i(0,"small",78),u(1,un,2,0,"div",70),n()),o&2){let e=p();s(),m("ngIf",e.addForm.country.errors==null?null:e.addForm.country.errors.required)}}function fn(o,r){o&1&&(i(0,"div"),a(1,"City is required"),n())}function hn(o,r){if(o&1&&(i(0,"small",78),u(1,fn,2,0,"div",70),n()),o&2){let e=p();s(),m("ngIf",e.addForm.city.errors==null?null:e.addForm.city.errors.required)}}function _n(o,r){o&1&&(i(0,"div"),a(1,"Province is required"),n())}function Cn(o,r){if(o&1&&(i(0,"small",78),u(1,_n,2,0,"div",70),n()),o&2){let e=p();s(),m("ngIf",e.addForm.province.errors==null?null:e.addForm.province.errors.required)}}function vn(o,r){o&1&&(i(0,"div"),a(1,"Zip Code is required"),n())}function bn(o,r){if(o&1&&(i(0,"small",78),u(1,vn,2,0,"div",70),n()),o&2){let e=p();s(),m("ngIf",e.addForm.zip_code.errors==null?null:e.addForm.zip_code.errors.required)}}function yn(o,r){o&1&&(i(0,"div"),a(1,"Please agree to the Terms and Conditions to continue."),n())}function xn(o,r){if(o&1&&(i(0,"small",78),u(1,yn,2,0,"div",70),n()),o&2){let e=p();s(),m("ngIf",e.addForm.agree.errors==null?null:e.addForm.agree.errors.required)}}function On(o,r){if(o&1&&(E(0),i(1,"div",80)(2,"span"),a(3),n(),i(4,"span"),a(5),S(6,"currency"),n()(),k()),o&2){let e=r.$implicit,t=r.index,l=p(2);s(3),rt("",e," (x",l.customerOrder.quantity[t],")"),s(2),v(w(6,3,l.customerOrder.subtotal[t],"PHP","symbol","1.2"))}}function Sn(o,r){if(o&1&&(i(0,"div",47),u(1,On,7,8,"ng-container",79),n()),o&2){let e=p();s(),m("ngForOf",e.customerOrder.item_name)}}function Pn(o,r){if(o&1&&(i(0,"option",81),a(1),n()),o&2){let e=r.$implicit;m("value",e),s(),v(e)}}function Mn(o,r){o&1&&(i(0,"small",78),a(1," Select a payment method "),n())}function wn(o,r){if(o&1&&(i(0,"li",82)(1,"strong")(2,"span",83),a(3,"Order"),n(),a(4),S(5,"uppercase"),n()()),o&2){let e=p();s(4),y(" #",ae(5,1,e.customerOrder.id),"")}}function In(o,r){if(o&1&&(i(0,"li",65),a(1),n()),o&2){let e=p();s(),y(" ",e.customerOrder.customer," ")}}function En(o,r){if(o&1&&(i(0,"li",65),a(1),n()),o&2){let e=p();s(),y(" ",e.customerOrder.location," ")}}function kn(o,r){if(o&1&&(i(0,"li",65),a(1," Status: "),i(2,"small"),a(3),n()()),o&2){let e=p();s(2),ue("badge bg-",e.badgeStyle[e.customerOrder.status],""),s(),v(e.customerOrder.status)}}function Fn(o,r){if(o&1&&(i(0,"li",65),a(1),n()),o&2){let e=p();s(),y(" Payment: ",e.customerOrder.payment_mode," ")}}function Un(o,r){if(o&1&&(i(0,"tr")(1,"td"),a(2),n(),i(3,"td"),a(4),n(),i(5,"td"),a(6),S(7,"currency"),n(),i(8,"td"),a(9),S(10,"currency"),n()()),o&2){let e=r.$implicit,t=r.index,l=p(2);s(2),v(e),s(2),v(l.customerOrder.quantity[t]),s(2),y(" ",w(7,4,l.customerOrder.subtotal[t]/l.customerOrder.quantity[t],"PHP","symbol","1.1-2")," "),s(3),y(" ",w(10,9,l.customerOrder.subtotal[t],"PHP","symbol","1.1-2")," ")}}function Tn(o,r){if(o&1&&(E(0),u(1,Un,11,14,"tr",79),k()),o&2){let e=p();s(),m("ngForOf",e.customerOrder.item_name)}}function qn(o,r){if(o&1&&(i(0,"p",84),a(1),S(2,"currency"),n()),o&2){let e=p();s(),y(" Total: ",w(2,1,e.getTotal(),"PHP","symbol","1.2")," ")}}var ze=class o{constructor(r,e,t,l,c,g,x){this.fb=r;this.messageService=e;this.orderService=t;this.authService=l;this.addService=c;this.cartService=g;this.router=x;this.customerUsername=sessionStorage.getItem("username"),this.customerFirstName=sessionStorage.getItem("first_name"),this.customerLastName=sessionStorage.getItem("last_name"),this.authService.getUserByUsername(this.customerUsername).subscribe(M=>{M.length>0&&(this.customerEmail=M[0].email,this.customerMobileNum=M[0].mobile_num)}),this.customerOrder={id:"",username:this.customerUsername,customer_img:"",customer:"",location:"",datetime:0,item_name:[],category:[],payment_mode:"",quantity:[],subtotal:[],status:""},this.orderService.getTempOrder(this.customerUsername).subscribe(M=>{this.customerOrder=M[0]}),this.checkoutForm=this.fb.group({paymentMethod:["Select payment method",b.required]}),this.addressForm=this.fb.group({first_name:["",b.required],last_name:["",b.required],email:["",[b.required,b.email]],mobile_num:["",[b.required,b.pattern(/^(9)\d{9}/),b.maxLength(10)]],country:["",b.required],city:["",b.required],province:["",b.required],zip_code:["",b.required],agree:[!1,b.required]}),this.paymentMethod="Select payment method",this.paymentMethods=["Cash on Delivery","Gcash","PayMaya","Credit Card"],this.badgeStyle={Delivered:"success",Pending:"warning",Shipped:"info",Cancelled:"danger"}}openReceiptModal;closeReceiptModal;customerOrder;submitted=!1;customerUsername;customerEmail="";customerFirstName;customerLastName;customerMobileNum="";checkoutForm;addressForm;paymentMethods=[];paymentMethod;badgeStyle;ngOnInit(){this.authService.getUserByUsername(this.customerUsername).subscribe(r=>{r.length>0&&(this.customerEmail=r[0].email,this.customerMobileNum=r[0].mobile_num,this.addressForm.patchValue({first_name:r[0].first_name,last_name:r[0].last_name,email:r[0].email,mobile_num:r[0].mobile_num}))})}capitalizeWord=r=>{let e=r.split(" "),t=" ";return e.forEach(l=>{t+=l.charAt(0).toUpperCase()+l.slice(1)+" "}),console.log(t.trim()),t.trim()};get f(){return this.checkoutForm.controls}get addForm(){return this.addressForm.controls}getTotal=()=>this.customerOrder.subtotal.reduce((r,e)=>r+e,0);endTransaction=()=>{this.router.navigate(["/home"])};onSubmit=()=>{this.submitted=!0;let r=this.checkoutForm.get("paymentMethod")?.value;r=r.includes("Cash")?"COD":r;let e=this.addressForm.getRawValue();if(e.country=this.capitalizeWord(e.country),e.city=this.capitalizeWord(e.city),e.province=this.capitalizeWord(e.province),e.username=this.customerUsername,delete e.agree,console.log(e),this.checkoutForm.invalid||r.includes("Select")||this.addressForm.invalid){this.messageService.add({severity:"error",summary:"Error",detail:"Please fill up all forms before check out"});return}console.log("username: ",this.customerUsername),this.addService.checkIfUserAddressExists(this.customerUsername).subscribe(t=>{t?this.addService.getAddressByUsername(this.customerUsername).subscribe(l=>{e.id=l[0].id,console.log(e.id),this.addService.updateUserAddress(e).subscribe(c=>{console.log("Address updated: ",c)},c=>{console.log("Failed to update address: ",c)})}):this.addService.addUserAddress(e).subscribe(l=>{console.log("Address added: ",l)},l=>{console.log("Failed adding address: ",l)})}),this.orderService.getTempOrder(this.customerUsername).subscribe(t=>{this.customerOrder=t[0]}),this.orderService.checkIfOrderExistsById(this.customerOrder.id).subscribe(t=>{t?this.orderService.getOrdersById(this.customerOrder.id).subscribe(l=>{this.customerOrder=l[0],this.customerOrder.id=l[0].id,this.customerOrder.location=e.city,this.customerOrder.payment_mode=r,this.customerOrder.customer_img=l[0].customer_img,this.orderService.updateOrder(this.customerOrder).subscribe(c=>{console.log("Updated order: ",c),this.openReceiptModal.nativeElement.click()},c=>{console.log("Failed to update order: ",c)})}):this.orderService.getTempOrder(this.customerUsername).subscribe(l=>{l.length>0&&(this.customerOrder=l[0],this.customerOrder.id=l[0].id,this.customerOrder.location=e.city,this.customerOrder.payment_mode=r,this.customerOrder.datetime=Date.now(),this.customerOrder.customer_img=l[0].customer_img,this.orderService.createOrder(this.customerOrder).subscribe(c=>{console.log("Created order: ",c),this.orderService.deleteTempOrder(this.customerOrder.id).subscribe(g=>{console.log("Deleted temp order: ",g)},g=>{console.log("Failed to delete temp order: ",g)}),this.cartService.getCartItems(this.customerUsername).subscribe(g=>{g.length>0&&this.cartService.removeCartItems(g[0].id).subscribe(x=>{console.log("Deleted cart: ",x),this.openReceiptModal.nativeElement.click()},x=>{console.log("Failed deleting cart: ",x)})})},c=>{console.log("Failed to create order: ",c)}))})}),r.includes("Select")||(this.submitted=!1)};static \u0275fac=function(e){return new(e||o)(h(Y),h(ee),h(te),h(X),h(je),h(N),h(L))};static \u0275cmp=T({type:o,selectors:[["app-checkout"]],viewQuery:function(e,t){if(e&1&&(ie(en,5),ie(tn,5)),e&2){let l;re(l=oe())&&(t.openReceiptModal=l.first),re(l=oe())&&(t.closeReceiptModal=l.first)}},decls:162,vars:63,consts:[["openReceiptModal",""],["closeReceiptModal",""],[1,"container"],[1,"row"],[1,"col-md-7"],[1,"card","p-4"],[1,"mb-3"],[3,"ngSubmit","formGroup"],[1,"col-md-6","mb-3"],["for","firstName",1,"form-label"],["type","text","formControlName","first_name","id","firstName","placeholder","John","required","",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["for","lastName",1,"form-label"],["type","text","formControlName","last_name","id","lastName","placeholder","Doe",1,"form-control",3,"ngClass"],["for","email",1,"form-label"],["type","email","formControlName","email","id","email","placeholder","john.doe@example.com","required","",1,"form-control",3,"ngClass"],[1,"row","mb-3"],[1,"col-md-3"],["for","phoneCode",1,"form-label"],["id","phoneCode",1,"form-select"],["value","+63"],["value","+1"],["value","+44"],[1,"col-md-9"],["for","phoneNumber",1,"form-label"],["type","tel","formControlName","mobile_num","id","phoneNumber","placeholder","9123456789","required","",1,"form-control",3,"ngClass"],["for","country",1,"form-label"],["type","text","formControlName","country","id","country","placeholder","Philippines","required","",1,"form-control",3,"ngClass"],["for","city",1,"form-label"],["type","text","formControlName","city","id","city","placeholder","San Fernando City","required","",1,"form-control",3,"ngClass"],["for","state",1,"form-label"],["type","text","formControlName","province","id","state","placeholder","Pampanga","required","",1,"form-control",3,"ngClass"],["for","zipCode",1,"form-label"],["type","text","formControlName","zip_code","id","zipCode","placeholder","2001","required","",1,"form-control",3,"ngClass"],[1,"form-check","mb-3"],["formControlName","agree","type","checkbox","id","terms","required","",1,"form-check-input",3,"ngClass"],["for","terms",1,"form-check-label"],[1,"col-md-5"],[1,"card","p-4","mb-4"],["class","checkout-summary",4,"ngIf"],[1,"card","p-4",3,"ngSubmit","formGroup"],["for","paymentMethod",1,"form-label"],["formControlName","paymentMethod","id","paymentMethod",1,"form-select",3,"ngClass"],["selected",""],[3,"value",4,"ngFor","ngForOf"],["for","voucher",1,"form-label"],["type","text","id","voucher","placeholder","Enter your code",1,"form-control"],[1,"checkout-summary"],[1,"summary-item"],[1,"summary-label"],["href","#viewReceiptModal","data-bs-toggle","modal"],["type","submit",1,"btn","pay-now-btn","w-100","mt-4"],["id","viewReceiptModal",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-bs-dismiss","modal",1,"btn-close",3,"click"],[1,"modal-body"],[1,"card"],[1,"card-body","mx-4"],[1,"my-3","mx-5","text-center",2,"font-size","24px"],[1,"list-unstyled"],[1,"order-date"],["class","text-muted mt-1",4,"ngIf"],[1,"text-black","mt-1"],[1,"customer-loc"],["class","text-black mt-1",4,"ngIf"],[1,"payment-status"],[1,"table","table-striped","table-hover"],[4,"ngIf"],[1,"row","text-black"],[1,"col-xl-12"],["class","float-end fw-bold",4,"ngIf"],[2,"border","2px solid black"],[1,"store"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal","value","Understood",1,"btn","btn-primary",3,"click"],[1,"invalid-feedback"],[4,"ngFor","ngForOf"],[1,"summary-item","mb-2"],[3,"value"],[1,"text-muted","mt-1"],[1,"text-black"],[1,"float-end","fw-bold"]],template:function(e,t){if(e&1){let l=U();i(0,"section")(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"h4",6),a(6,"Customer Information"),n(),i(7,"form",7),f("ngSubmit",function(){return _(l),C(t.onSubmit())}),i(8,"div",3)(9,"div",8)(10,"label",9),a(11,"First Name"),n(),d(12,"input",10),u(13,rn,2,1,"small",11),n(),i(14,"div",8)(15,"label",12),a(16,"Last Name"),n(),d(17,"input",13),u(18,an,2,1,"small",11),n()(),i(19,"div",6)(20,"label",14),a(21,"Email Address"),n(),d(22,"input",15),u(23,mn,3,2,"small",11),n(),i(24,"div",16)(25,"div",17)(26,"label",18),a(27,"Country Code"),n(),i(28,"select",19)(29,"option",20),a(30,"+63 (PH)"),n(),i(31,"option",21),a(32,"+1 (US)"),n(),i(33,"option",22),a(34,"+44 (UK)"),n()()(),i(35,"div",23)(36,"label",24),a(37,"Phone Number"),n(),d(38,"input",25),u(39,pn,3,2,"small",11),n()(),i(40,"div",3)(41,"div",8)(42,"label",26),a(43,"Country"),n(),d(44,"input",27),u(45,gn,2,1,"small",11),n(),i(46,"div",8)(47,"label",28),a(48,"City"),n(),d(49,"input",29),u(50,hn,2,1,"small",11),n()(),i(51,"div",3)(52,"div",8)(53,"label",30),a(54,"Province"),n(),d(55,"input",31),u(56,Cn,2,1,"small",11),n(),i(57,"div",8)(58,"label",32),a(59,"Zip Code"),n(),d(60,"input",33),u(61,bn,2,1,"small",11),n()(),i(62,"div",34),d(63,"input",35),i(64,"label",36),a(65," I have read and agree to the Terms and Conditions "),n(),u(66,xn,2,1,"small",11),n()()()(),i(67,"div",37)(68,"div",38)(69,"h4",6),a(70,"Your Order"),n(),u(71,Sn,2,1,"div",39),n(),i(72,"form",40),f("ngSubmit",function(){return _(l),C(t.onSubmit())}),i(73,"h4",6),a(74,"Payment"),n(),i(75,"div",6)(76,"label",41),a(77,"Select Payment Method"),n(),i(78,"select",42)(79,"option",43),a(80,"Select payment method"),n(),u(81,Pn,2,2,"option",44),n(),u(82,Mn,2,0,"small",11),n(),i(83,"div",6)(84,"label",45),a(85,"Voucher"),n(),d(86,"input",46),n(),i(87,"div",47)(88,"div",48)(89,"span",49),a(90,"Subtotal:"),n(),i(91,"span"),a(92),S(93,"currency"),n()(),i(94,"div",48)(95,"span",49),a(96,"Shipping:"),n(),i(97,"span"),a(98,"\u20B170.00"),n()(),i(99,"div",48)(100,"span",49),a(101,"Discount:"),n(),i(102,"span"),a(103,"-\u20B10.00"),n()(),i(104,"div",48)(105,"span",49),a(106,"Total:"),n(),i(107,"span"),a(108),S(109,"currency"),n()()(),d(110,"a",50,0),i(112,"button",51),a(113,"Pay Now"),n()()()()(),i(114,"div",52)(115,"div",53)(116,"div",54)(117,"form")(118,"div",55)(119,"h5",56),a(120,"Receipt"),n(),i(121,"button",57,1),f("click",function(){return _(l),C(t.endTransaction())}),n()(),i(123,"div",58)(124,"div",59)(125,"div",60)(126,"div",2)(127,"p",61),a(128,"Thank for your purchase!"),n(),i(129,"div",3)(130,"ul",62)(131,"div",63),u(132,wn,6,3,"li",64),i(133,"li",65),a(134," Jun 23, 2023, 11:37 AM "),n()(),i(135,"div",66),u(136,In,2,1,"li",67)(137,En,2,1,"li",67),n(),i(138,"div",68),u(139,kn,4,4,"li",67)(140,Fn,2,1,"li",67),n()(),i(141,"table",69)(142,"thead")(143,"tr")(144,"th"),a(145,"Item"),n(),i(146,"th"),a(147,"Qty"),n(),i(148,"th"),a(149,"Unit Price"),n(),i(150,"th"),a(151,"Subtotal"),n()()(),i(152,"tbody"),u(153,Tn,2,1,"ng-container",70),n()()(),i(154,"div",71)(155,"div",72),u(156,qn,3,6,"p",73),n(),d(157,"hr",74),n(),i(158,"p",75),a(159,"Click&Get Online Convenience Store"),n()()()()(),i(160,"div",76)(161,"input",77),f("click",function(){return _(l),C(t.endTransaction())}),n()()()()()()()}e&2&&(s(7),m("formGroup",t.addressForm),s(5),m("ngClass",P(43,R,t.submitted&&t.addForm.first_name.errors)),s(),m("ngIf",t.addForm.first_name.invalid&&(t.addForm.first_name.dirty||t.addForm.last_name.touched)),s(4),m("ngClass",P(45,R,t.submitted&&t.addForm.last_name.errors)),s(),m("ngIf",t.addForm.last_name.invalid&&(t.addForm.last_name.dirty||t.addForm.last_name.touched)),s(4),m("ngClass",P(47,R,t.submitted&&t.addForm.email.errors)),s(),m("ngIf",t.addForm.email.invalid&&(t.addForm.email.dirty||t.addForm.email.touched)),s(15),m("ngClass",P(49,R,t.submitted&&t.addForm.mobile_num.errors||t.addForm.mobile_num.touched&&((t.addForm.mobile_num.errors==null?null:t.addForm.mobile_num.errors.pattern)||(t.addForm.mobile_num.errors==null?null:t.addForm.mobile_num.errors.maxlength)))),s(),m("ngIf",t.addForm.mobile_num.invalid&&(t.addForm.mobile_num.dirty||t.addForm.mobile_num.touched)),s(5),m("ngClass",P(51,R,t.submitted&&t.addForm.country.errors)),s(),m("ngIf",t.addForm.country.invalid&&(t.addForm.country.dirty||t.addForm.country.touched)),s(4),m("ngClass",P(53,R,t.submitted&&t.addForm.city.errors)),s(),m("ngIf",t.addForm.city.invalid&&(t.addForm.city.dirty||t.addForm.city.touched)),s(5),m("ngClass",P(55,R,t.submitted&&t.addForm.province.errors)),s(),m("ngIf",t.addForm.province.invalid&&(t.addForm.province.dirty||t.addForm.province.touched)),s(4),m("ngClass",P(57,R,t.submitted&&t.addForm.zip_code.errors)),s(),m("ngIf",t.addForm.zip_code.invalid&&(t.addForm.zip_code.dirty||t.addForm.zip_code.touched)),s(2),m("ngClass",P(59,R,t.submitted&&t.addForm.agree.errors)),s(3),m("ngIf",t.addForm.agree.invalid&&(t.addForm.agree.dirty||t.addForm.agree.touched)),s(5),m("ngIf",t.customerOrder.item_name.length>0),s(),m("formGroup",t.checkoutForm),s(6),m("ngClass",P(61,R,t.submitted&&t.f.paymentMethod.value==="Select payment method")),s(3),m("ngForOf",t.paymentMethods),s(),m("ngIf",t.f.paymentMethod.value==="Select payment method"&&t.submitted),s(10),v(w(93,33,t.getTotal(),"PHP","symbol","1.2")),s(16),v(w(109,38,t.getTotal()+70,"PHP","symbol","1.2")),s(24),m("ngIf",t.customerOrder),s(4),m("ngIf",t.customerOrder),s(),m("ngIf",t.customerOrder),s(2),m("ngIf",t.customerOrder),s(),m("ngIf",t.customerOrder),s(13),m("ngIf",t.customerOrder),s(3),m("ngIf",t.customerOrder))},dependencies:[G,Q,A,j,me,ce,D,at,Ue,$,B,lt,st,K,J,Ie,Me,H],styles:["section[_ngcontent-%COMP%]{height:100%;background-color:#f5f5f5;margin-bottom:20px}.container[_ngcontent-%COMP%]{padding-top:50px}.card[_ngcontent-%COMP%]{border:none;box-shadow:0 0 15px #0000001a}.checkout-summary[_ngcontent-%COMP%]{background-color:#e9ecef;padding:20px;border-radius:8px}.summary-label[_ngcontent-%COMP%]{font-weight:700}.summary-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.pay-now-btn[_ngcontent-%COMP%]{background-color:#000;color:#fff}.form-check-label[_ngcontent-%COMP%]{font-size:14px}.is-invalid[_ngcontent-%COMP%]{border-color:#dc3545}.invalid-feedback[_ngcontent-%COMP%]{color:#dc3545;font-size:.875rem}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]{max-width:600px;max-height:1000px;height:100%}.modal[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{padding:20px 30px}.modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{border-radius:3px;font-size:14px}.modal[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{background:#ecf0f1;border-radius:0 0 3px 3px}.modal[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]{display:inline-block}.modal[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{border-radius:2px;box-shadow:none;border-color:#ddd}.modal[_ngcontent-%COMP%]   textarea.form-control[_ngcontent-%COMP%]{resize:vertical}.modal[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{border-radius:2px;min-width:100px}.modal[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:400}.modal[_ngcontent-%COMP%]   .order-date[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]   .customer-loc[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]   .payment-status[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start}.store[_ngcontent-%COMP%]{text-align:center;font-size:14px;color:gray;margin-bottom:-10px}"]})};var Nn=o=>({active:o});function Vn(o,r){o&1&&(i(0,"div",79)(1,"a",80),a(2,"Profile"),n(),i(3,"a",81),a(4,"Banks & Cards"),n(),i(5,"a",81),a(6,"Addresses"),n(),i(7,"a",81),a(8,"Change Password"),n(),i(9,"a",81),a(10,"Privacy Settings"),n(),i(11,"a",81),a(12,"Notification Settings"),n()())}function An(o,r){if(o&1&&(i(0,"option",82),a(1),n()),o&2){let e=r.$implicit;m("value",e),s(),v(e)}}function Ln(o,r){if(o&1&&(i(0,"option",82),a(1),n()),o&2){let e=r.$implicit;m("value",e),s(),y(" ",e," ")}}function Dn(o,r){if(o&1&&(i(0,"option",82),a(1),n()),o&2){let e=r.$implicit;m("value",e),s(),y(" ",e," ")}}function $n(o,r){if(o&1&&(E(0),i(1,"p"),a(2),n(),k()),o&2){let e=r.$implicit;s(2),v(e)}}function Bn(o,r){if(o&1&&(E(0),i(1,"p"),a(2),n(),k()),o&2){let e=r.$implicit;s(2),v(e)}}function jn(o,r){if(o&1&&(E(0),i(1,"p"),a(2),S(3,"currency"),n(),k()),o&2){let e=r.$implicit;s(2),v(e!=="..."?Qe(3,1,e,"PHP"):e)}}function zn(o,r){if(o&1){let e=U();i(0,"tr")(1,"td",83),f("click",function(){let l=_(e).index,c=p();return C(c.viewOrderSummary(l))}),a(2),n(),i(3,"td",83),f("click",function(){let l=_(e).index,c=p();return C(c.viewOrderSummary(l))}),a(4),S(5,"date"),n(),i(6,"td",83),f("click",function(){let l=_(e).index,c=p();return C(c.viewOrderSummary(l))}),a(7),n(),i(8,"td",83),f("click",function(){let l=_(e).index,c=p();return C(c.viewOrderSummary(l))}),i(9,"small"),a(10),n()(),i(11,"td",83),f("click",function(){let l=_(e).index,c=p();return C(c.viewOrderSummary(l))}),u(12,$n,3,1,"ng-container",48),n(),i(13,"td",83),f("click",function(){let l=_(e).index,c=p();return C(c.viewOrderSummary(l))}),u(14,Bn,3,1,"ng-container",48),n(),i(15,"td",83),f("click",function(){let l=_(e).index,c=p();return C(c.viewOrderSummary(l))}),u(16,jn,4,4,"ng-container",48),n(),i(17,"td",84)(18,"a",85),d(19,"i",86),n(),i(20,"ul",87)(21,"li")(22,"a",88),f("click",function(){let l=_(e).index,c=p();return C(c.updateOrderStatus(l,"Pending"))}),d(23,"i",89),a(24," Pending"),n()(),i(25,"li"),d(26,"hr",90),n(),i(27,"li")(28,"a",88),f("click",function(){let l=_(e).index,c=p();return C(c.updateOrderStatus(l,"Cancelled"))}),d(29,"i",91),a(30," Cancelled"),n()()()()()}if(o&2){let e=r.$implicit,t=r.index,l=p();s(2),y(" ",e.location," "),s(2),y(" ",Qe(5,10,e.datetime,"short")," "),s(3),y(" ",e.payment_mode," "),s(2),ue("badge bg-",l.badgeStyle[e.status],""),s(),v(e.status),s(2),m("ngForOf",l.truncatedOrders[t].item_name),s(2),m("ngForOf",l.truncatedOrders[t].quantity),s(2),m("ngForOf",l.truncatedOrders[t].subtotal)}}function Rn(o,r){if(o&1){let e=U();E(0),i(1,"li",92)(2,"button",53),f("click",function(){let l=_(e).$implicit,c=p();return C(c.gotoPage(l))}),a(3),n()(),k()}if(o&2){let e=r.$implicit,t=p();s(),m("ngClass",P(3,Nn,t.currentPage===e)),s(),m("disabled",t.currentPage===e),s(),y(" ",e," ")}}function Gn(o,r){if(o&1&&(i(0,"li",93)(1,"strong")(2,"span",94),a(3,"Order"),n(),a(4),S(5,"uppercase"),n()()),o&2){let e=p();s(4),y(" #",ae(5,1,e.selectedOrder.id),"")}}function Qn(o,r){if(o&1&&(i(0,"li",67),a(1),n()),o&2){let e=p();s(),y(" ",e.selectedOrder.customer," ")}}function Hn(o,r){if(o&1&&(i(0,"li",67),a(1),n()),o&2){let e=p();s(),y(" ",e.selectedOrder.location," ")}}function Wn(o,r){if(o&1&&(i(0,"li",67),a(1," Status: "),i(2,"small"),a(3),n()()),o&2){let e=p();s(2),ue("badge bg-",e.badgeStyle[e.selectedOrder.status],""),s(),v(e.selectedOrder.status)}}function Kn(o,r){if(o&1&&(i(0,"li",67),a(1),n()),o&2){let e=p();s(),y(" Payment: ",e.selectedOrder.payment_mode," ")}}function Jn(o,r){if(o&1&&(i(0,"tr")(1,"td"),a(2),n(),i(3,"td"),a(4),n(),i(5,"td"),a(6),S(7,"currency"),n(),i(8,"td"),a(9),S(10,"currency"),n()()),o&2){let e=r.$implicit,t=r.index,l=p(2);s(2),v(e),s(2),v(l.selectedOrder.quantity[t]),s(2),y(" ",w(7,4,l.selectedOrder.subtotal[t]/l.selectedOrder.quantity[t],"PHP","symbol","1.1-2")," "),s(3),y(" ",w(10,9,l.selectedOrder.subtotal[t],"PHP","symbol","1.1-2")," ")}}function Yn(o,r){if(o&1&&(E(0),u(1,Jn,11,14,"tr",48),k()),o&2){let e=p();s(),m("ngForOf",e.selectedOrder.item_name)}}function Zn(o,r){if(o&1&&(i(0,"p",95),a(1),S(2,"currency"),n()),o&2){let e=p();s(),y(" Total: ",w(2,1,e.getTotal(),"PHP","symbol","1.2")," ")}}var Re=class o{constructor(r,e,t,l){this.orderService=r;this.messageService=e;this.awsS3Service=t;this.cartService=l;this.customerUsername=sessionStorage.getItem("username"),this.customerName=`${sessionStorage.getItem("first_name")} ${sessionStorage.getItem("last_name")}`,this.myOrders$=this.orderService.getOrdersByUsername(this.customerUsername.trim()).pipe(O(c=>c.filter(g=>g.username.toLowerCase().trim()===this.customerUsername.toLowerCase().trim()))),this.cartService.getCartItems(this.customerUsername).subscribe(c=>{c.length>0&&(this.cartItemCount=c[0].item_name.length)}),this.s3Folder="assets/users",this.profileDefaultImg=`${this.s3Folder}/default_profile_img-100.png`,this.savedImageUrl=`${this.s3Folder}/default_profile_img-100.png`,this.myOrders$.pipe(O(c=>c.filter(g=>g.username.trim().toLowerCase()===this.customerUsername.toLowerCase().trim()))).subscribe(c=>{this.ordersLength=c.length,console.log(c),this.pageSize=this.ordersLength>5?5:this.ordersLength,this.totalLength=this.ordersLength,c.forEach(g=>F(this,null,function*(){g.item_name.length>1?this.truncatedOrders.push({item_name:[...g.item_name.slice(0,1),"..."],quantity:[...g.quantity.slice(0,1).map(x=>x.toString()),"..."],subtotal:[...g.subtotal.slice(0,1).map(x=>x.toString()),"..."]}):this.truncatedOrders.push({item_name:g.item_name,quantity:g.quantity,subtotal:g.subtotal}),this.savedImageUrl=yield this.awsS3Service.getSignedUrl(`${this.s3Folder}/${g.customer_img}`),this.imageUrls.push(yield this.awsS3Service.getSignedUrl(`${this.s3Folder}/${g.customer_img}`)),console.log(g.customer_img)}))}),this.badgeStyle={Delivered:"success",Pending:"warning",Shipped:"info",Cancelled:"danger"}}customerUsername;customerName;myOrders$;ordersLength=0;isSubMenuVisible=!1;cartItemCount=0;paginatedOrders$;currentPage=1;pageSize=5;totalPages=0;pageNumbers=[];availablePageSizes=[5,10,15,20];totalLength=0;currentPageLength=0;checkedItems=[];badgeStyle;selectedOrder;searchQuery;locationList=[];statusList=[];selectedLocation="All";selectedStatus="Any";truncatedOrders=[];s3Folder;imageUrls=[];profileDefaultImg;savedImageUrl;ngOnInit(){this.myOrders$.pipe(O(r=>["All",...new Set(r.map(e=>e.location))])).subscribe(r=>{this.locationList=r}),this.myOrders$.pipe(O(r=>["Any",...new Set(r.map(e=>e.status))])).subscribe(r=>{this.statusList=r}),this.filterLocation(this.selectedLocation),this.filterStatus(this.selectedStatus),this.myOrders$.pipe(O(r=>r.filter(e=>e.username.toLowerCase().trim()===this.customerUsername.toLowerCase().trim()))).subscribe(r=>{this.totalLength=r.length,this.updatePagination(r),r.forEach(e=>F(this,null,function*(){this.savedImageUrl=yield this.awsS3Service.getSignedUrl(`${this.s3Folder}/${e.customer_img}`)}))}),this.paginateOrders()}toggleSubmenu=()=>{this.isSubMenuVisible=!this.isSubMenuVisible};generatePageNumbers=()=>{this.pageNumbers=Array.from({length:this.totalPages},(r,e)=>e+1)};updatePagination(r){this.totalPages=Math.ceil(r.length/this.pageSize),this.generatePageNumbers()}paginateOrders=()=>{this.paginatedOrders$=this.myOrders$.pipe(O(r=>{let e=r.filter(c=>c.username.toLowerCase().trim()===this.customerUsername.toLowerCase().trim()),t=(this.currentPage-1)*this.pageSize,l=Math.min(t+this.pageSize,r.length);return this.currentPageLength+=l-this.currentPageLength,console.log("paginatedOrders: ",e.slice(t,l)),e.slice(t,l)}))};nextPage=()=>{this.currentPage<this.totalPages&&(this.currentPage++,this.paginateOrders())};prevPage=()=>{this.currentPage>1&&(this.currentPage--,this.paginateOrders())};gotoPage=r=>{this.currentPage=r,this.paginateOrders()};onPageSizeChange=r=>{let e=r.target;this.pageSize=parseInt(e.value),this.currentPage=1,this.myOrders$.subscribe(t=>{})};onCheck=r=>{this.checkedItems.includes(r)?this.checkedItems=this.checkedItems.filter(e=>e!==r):this.checkedItems.push(r)};getTotal=()=>this.selectedOrder?this.selectedOrder.subtotal.reduce((r,e)=>r+e,0):0;viewOrderSummary=r=>{this.paginatedOrders$.pipe(O(e=>e[r])).subscribe(e=>{this.selectedOrder=e})};updateOrderStatus=(r,e)=>{this.paginatedOrders$.pipe(O(t=>t[r])).subscribe(t=>{t.status==="Pending"?(t.status=e,this.orderService.updateOrder(t).subscribe(l=>{console.log("Updated order status: ",l),this.myOrders$=this.orderService.getOrders(),this.searchOrder(),this.messageService.add({severity:"success",summary:"Success",detail:"Updated order status"})},l=>{this.messageService.add({severity:"error",summary:"Error",detail:"Failed to update order status"})})):this.messageService.add({severity:"error",summary:"Error",detail:`Order has already been ${t.status==="Shipped"?"shipped":"delivered"}`})})};searchOrder=()=>{this.searchQuery?this.myOrders$=this.orderService.getOrders().pipe(O(r=>r.filter(e=>e.item_name.some(t=>t.toLowerCase().includes(this.searchQuery.toLowerCase()))||e.customer.toLowerCase().includes(this.searchQuery.toLowerCase())||e.category.some(t=>t.toLowerCase().includes(this.searchQuery))))):this.myOrders$=this.orderService.getOrders(),this.paginateOrders()};filterLocation=r=>{this.myOrders$=this.orderService.getOrders().pipe(O(e=>r==="All"?e:e.filter(t=>t.location.toLowerCase().includes(r.toLowerCase())))),this.paginateOrders()};onLocationChange=r=>{let t=r.target.value;this.selectedLocation=t,this.filterLocation(t)};filterStatus=r=>{this.myOrders$=this.orderService.getOrders().pipe(O(e=>r==="Any"?e:e.filter(t=>t.status.toLowerCase().includes(r.toLowerCase())))),this.paginateOrders()};onStatusChange=r=>{let t=r.target.value;this.selectedStatus=t,this.filterStatus(t)};refreshOrdersTable=()=>{this.myOrders$=this.orderService.getOrdersByUsername(this.customerUsername)};static \u0275fac=function(e){return new(e||o)(h(te),h(ee),h(Z),h(N))};static \u0275cmp=T({type:o,selectors:[["app-my-purchases"]],decls:173,vars:23,consts:[["closeModalEdit",""],[3,"itemCountInput"],[1,"container","mt-4","profile-container"],[1,"row"],[1,"col-md-3"],[1,"side-menu"],[1,"small-profile","text-center","mb-4"],["alt","User Avatar",1,"rounded-circle",3,"src"],[1,"mt-2"],[1,"nav","nav-pills","flex-column","mb-auto"],[1,"nav-item"],["id","my-account",1,"nav-link",3,"click"],[1,"bi","bi-person-circle"],["class","submenu",4,"ngIf"],["routerLink","/home/purchases","routerLinkActive","router-link-active",1,"nav-link"],[1,"bi","bi-cart"],["href","#","routerLinkActive","router-link-active",1,"nav-link"],[1,"bi","bi-bell"],[1,"bi","bi-ticket"],[1,"col-md-9"],[1,"profile-container"],[1,"purchases-table"],[1,"table-container"],[1,"table-responsive"],[1,"table-wrapper"],[1,"table-title"],[1,"col-sm-4"],[1,"col-sm-8"],[1,"btn","btn-primary",3,"click"],[1,"material-icons"],["href","#",1,"btn","btn-secondary"],[1,"table-filter"],[1,"col-sm-3"],[1,"show-entries"],[1,"page-select","form-select",3,"change"],[3,"value",4,"ngFor","ngForOf"],[1,"filter-right","col-sm-9"],[1,"filter-search-group"],["type","button",1,"btn","btn-primary"],[1,"fa","fa-search"],[1,"filter-group"],["type","search",1,"form-control",3,"ngModelChange","keyup","ngModel"],[1,"filter-loc-group","filter-group"],[1,"form-select",3,"change"],[1,"filter-status-group","filter-group"],[1,"filter-icon"],[1,"fa","fa-filter"],[1,"table","table-striped","table-hover"],[4,"ngFor","ngForOf"],[1,"clearfix"],[1,"hint-text"],[1,"pagination"],[1,"page-item"],[1,"btn","btn-link",3,"click","disabled"],["id","viewOrderModal",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-bs-dismiss","modal",1,"btn-close"],[1,"modal-body"],[1,"card"],[1,"card-body","mx-4"],[1,"container"],[1,"list-unstyled"],[1,"order-date"],["class","text-muted mt-1",4,"ngIf"],[1,"text-black","mt-1"],[1,"customer-loc"],["class","text-black mt-1",4,"ngIf"],[1,"payment-status"],[4,"ngIf"],[1,"row","text-black"],[1,"col-xl-12"],["class","float-end fw-bold",4,"ngIf"],[2,"border","2px solid black"],[1,"store"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal","value","Understood",1,"btn","btn-primary"],[1,"submenu"],["routerLink","/home/profile","routerLinkActive","router-link-active",1,"nav-link"],["href","#",1,"nav-link"],[3,"value"],["data-bs-toggle","modal","data-bs-target","#viewOrderModal",3,"click"],[1,"dropdown"],["href","#","title","View Details","data-toggle","tooltip","role","button","data-bs-toggle","dropdown",1,"view","dropdown-toggle"],[1,"fa-solid","fa-gear"],[1,"dropdown-menu","dropdown-menu-end"],[1,"dropdown-item",3,"click"],[1,"fa-solid","fa-spinner"],[1,"dropdown-divider"],[1,"fa-solid","fa-ban"],[1,"page-item",3,"ngClass"],[1,"text-muted","mt-1"],[1,"text-black"],[1,"float-end","fw-bold"]],template:function(e,t){if(e&1){let l=U();i(0,"section"),d(1,"app-navbar",1),i(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),d(7,"img",7),i(8,"p",8),a(9),n()(),d(10,"hr"),i(11,"ul",9)(12,"li",10)(13,"a",11),f("click",function(){return _(l),C(t.toggleSubmenu())}),d(14,"i",12),a(15," My Account "),n(),u(16,Vn,13,0,"div",13),n(),i(17,"li")(18,"a",14),d(19,"i",15),a(20," My Purchases "),n()(),i(21,"li")(22,"a",16),d(23,"i",17),a(24," Notifications "),n()(),i(25,"li")(26,"a",16),d(27,"i",18),a(28," My Vouchers "),n()()()()(),i(29,"div",19)(30,"div",20)(31,"h4"),a(32,"My Purchases"),n(),i(33,"p"),a(34,"View and manage your purchases"),n(),d(35,"hr"),i(36,"div",21)(37,"div",22)(38,"div",23)(39,"div",24)(40,"div",25)(41,"div",3)(42,"div",26)(43,"h2"),a(44,"Order "),i(45,"b"),a(46,"Details"),n()()(),i(47,"div",27)(48,"a",28),f("click",function(){return _(l),C(t.refreshOrdersTable())}),i(49,"i",29),a(50,"\uE863"),n(),i(51,"span"),a(52,"Refresh List"),n()(),i(53,"a",30)(54,"i",29),a(55,"\uE24D"),n(),i(56,"span"),a(57,"Export to Excel"),n()()()()(),i(58,"div",31)(59,"div",3)(60,"div",32)(61,"div",33)(62,"span"),a(63,"Show"),n(),i(64,"select",34),f("change",function(g){return _(l),C(t.onPageSizeChange(g))}),u(65,An,2,2,"option",35),n(),i(66,"span"),a(67,"entries"),n()()(),i(68,"div",36)(69,"div",37)(70,"button",38),d(71,"i",39),n(),i(72,"div",40)(73,"label"),a(74,"Search"),n(),i(75,"input",41),Se("ngModelChange",function(g){return _(l),Oe(t.searchQuery,g)||(t.searchQuery=g),C(g)}),f("keyup",function(){return _(l),C(t.searchOrder())}),n()()(),i(76,"div",42)(77,"label"),a(78,"Location"),n(),i(79,"select",43),f("change",function(g){return _(l),C(t.onLocationChange(g))}),u(80,Ln,2,2,"option",35),n()(),i(81,"div",44)(82,"label"),a(83,"Status"),n(),i(84,"select",43),f("change",function(g){return _(l),C(t.onStatusChange(g))}),u(85,Dn,2,2,"option",35),n()(),i(86,"span",45),d(87,"i",46),n()()()(),i(88,"table",47)(89,"thead")(90,"tr")(91,"th"),a(92,"Location"),n(),i(93,"th"),a(94,"Order Date"),n(),i(95,"th"),a(96,"Payment Mode"),n(),i(97,"th"),a(98,"Status"),n(),i(99,"th"),a(100,"Item Name"),n(),i(101,"th"),a(102,"Quantity"),n(),i(103,"th"),a(104,"Subtotal"),n(),i(105,"th"),a(106,"Action"),n()()(),i(107,"tbody"),u(108,zn,31,13,"tr",48),S(109,"async"),n()(),i(110,"div",49)(111,"div",50),a(112," Showing "),i(113,"b"),a(114),n(),a(115," out of "),i(116,"b"),a(117),n(),a(118," entries "),n(),i(119,"ul",51)(120,"li",52)(121,"button",53),f("click",function(){return _(l),C(t.prevPage())}),a(122," Previous "),n()(),u(123,Rn,4,5,"ng-container",48),i(124,"li",52)(125,"button",53),f("click",function(){return _(l),C(t.nextPage())}),a(126," Next "),n()()()()()()()()()()()()(),i(127,"div",54)(128,"div",55)(129,"div",56)(130,"form")(131,"div",57)(132,"h5",58),a(133,"Order Summary"),n(),d(134,"button",59,0),n(),i(136,"div",60)(137,"div",61)(138,"div",62)(139,"div",63)(140,"div",3)(141,"ul",64)(142,"div",65),u(143,Gn,6,3,"li",66),i(144,"li",67),a(145," Jun 23, 2023, 11:37 AM "),n()(),i(146,"div",68),u(147,Qn,2,1,"li",69)(148,Hn,2,1,"li",69),n(),i(149,"div",70),u(150,Wn,4,4,"li",69)(151,Kn,2,1,"li",69),n()(),i(152,"table",47)(153,"thead")(154,"tr")(155,"th"),a(156,"Item"),n(),i(157,"th"),a(158,"Qty"),n(),i(159,"th"),a(160,"Unit Price"),n(),i(161,"th"),a(162,"Subtotal"),n()()(),i(163,"tbody"),u(164,Yn,2,1,"ng-container",71),n()()(),i(165,"div",72)(166,"div",73),u(167,Zn,3,6,"p",74),n(),d(168,"hr",75),n(),i(169,"p",76),a(170,"Click&Get Online Grocery Store"),n()()()()(),i(171,"div",77),d(172,"input",78),n()()()()()}e&2&&(s(),m("itemCountInput",t.cartItemCount),s(6),q("src",t.savedImageUrl?t.savedImageUrl:t.profileDefaultImg,V),s(2),v(t.customerName),s(7),m("ngIf",t.isSubMenuVisible),s(49),m("ngForOf",t.availablePageSizes),s(10),xe("ngModel",t.searchQuery),s(5),m("ngForOf",t.locationList),s(5),m("ngForOf",t.statusList),s(23),m("ngForOf",ae(109,21,t.paginatedOrders$)),s(6),v(t.currentPageLength),s(3),v(t.totalLength),s(4),m("disabled",t.currentPage===1),s(2),m("ngForOf",t.pageNumbers),s(2),m("disabled",t.currentPage===t.totalPages),s(18),m("ngIf",t.selectedOrder),s(4),m("ngIf",t.selectedOrder),s(),m("ngIf",t.selectedOrder),s(2),m("ngIf",t.selectedOrder),s(),m("ngIf",t.selectedOrder),s(13),m("ngIf",t.selectedOrder),s(3),m("ngIf",t.selectedOrder))},dependencies:[G,Q,A,W,se,ne,j,me,ce,D,$,B,Ee,Ie,Pe,Me,H,ot],styles:['section[_ngcontent-%COMP%]{background-color:#f5f5f5}.profile-container[_ngcontent-%COMP%]{background-color:#fff;padding:20px;border-radius:5px;box-shadow:0 0 10px #0000001a}.side-menu[_ngcontent-%COMP%]{background-color:#fff;padding:20px;border-radius:5px;box-shadow:0 0 10px #0000001a;height:100%}.side-menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#000;text-decoration:none;display:block;padding:10px 0;border-bottom:1px solid #f1f1f1}.side-menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .side-menu[_ngcontent-%COMP%]   a.router-link-active[_ngcontent-%COMP%]{color:#2c3ce980}.side-menu[_ngcontent-%COMP%]   .submenu[_ngcontent-%COMP%]{padding-left:20px}.side-menu[_ngcontent-%COMP%]   .submenu[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{padding-left:30px}.side-menu[_ngcontent-%COMP%]   #my-account[_ngcontent-%COMP%]{cursor:pointer}.dropdown-container[_ngcontent-%COMP%]{display:none;padding-left:15px}.purchases-table[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-around}.small-profile[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:90px;height:90px;border-radius:50%;object-fit:cover;border:2px solid #e9ecef}.small-profile[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:20px}.form-control.is-invalid[_ngcontent-%COMP%]{border-color:#dc3545}.invalid-feedback[_ngcontent-%COMP%]{color:#dc3545;font-size:.875rem}.btn-primary[_ngcontent-%COMP%]{background-color:#007bff;border:none}.btn-primary[_ngcontent-%COMP%]:disabled{background-color:#d1e7fd}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:middle}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]{max-width:600px;max-height:1000px;height:100%}.modal[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{padding:20px 30px}.modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{border-radius:3px;font-size:14px}.modal[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{background:#ecf0f1;border-radius:0 0 3px 3px}.modal[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]{display:inline-block}.modal[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{border-radius:2px;box-shadow:none;border-color:#ddd}.modal[_ngcontent-%COMP%]   textarea.form-control[_ngcontent-%COMP%]{resize:vertical}.modal[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{border-radius:2px;min-width:100px}.modal[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:400}.modal[_ngcontent-%COMP%]   .order-date[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]   .customer-loc[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]   .payment-status[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start}.table-responsive[_ngcontent-%COMP%]{margin:30px 0}.table-wrapper[_ngcontent-%COMP%]{min-width:800px;background:#fff;padding:20px 25px;border-radius:3px;box-shadow:0 1px 1px #0000000d;overflow-x:hidden}.table-wrapper[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{float:right;color:#333;background-color:#fff;border-radius:3px;border:none;outline:none!important;margin-left:10px}.table-wrapper[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover{color:#333;background:#f2f2f2}.table-wrapper[_ngcontent-%COMP%]   .btn.btn-primary[_ngcontent-%COMP%]{color:#fff;background:#03a9f4}.table-wrapper[_ngcontent-%COMP%]   .btn.btn-primary[_ngcontent-%COMP%]:hover{background:#03a3e7}.table-title[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{font-size:13px;border:none}.table-title[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{float:left;font-size:21px;margin-right:5px}.table-title[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{float:left;margin-top:2px}.table-title[_ngcontent-%COMP%]{color:#fff;background:#4b5366;padding:16px 25px;margin:-20px -25px 10px;border-radius:3px 3px 0 0}.table-title[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:5px 0 0;font-size:24px}.show-entries[_ngcontent-%COMP%]   select.form-select[_ngcontent-%COMP%]{width:70px;margin:0 5px}.table-filter[_ngcontent-%COMP%]   .filter-right[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto;grid-template-rows:auto;grid-template-areas:"filterIcon statusGroup locationGroup searchGroup";column-gap:0;justify-items:center;align-items:center}.table-filter[_ngcontent-%COMP%]   .filter-search-group[_ngcontent-%COMP%]{grid-area:searchGroup}.table-filter[_ngcontent-%COMP%]   .filter-loc-group[_ngcontent-%COMP%]{grid-area:locationGroup}.table-filter[_ngcontent-%COMP%]   .filter-status-group[_ngcontent-%COMP%]{grid-area:statusGroup}.table-filter[_ngcontent-%COMP%]   .filter-icon[_ngcontent-%COMP%]{grid-area:filterIcon}.table-filter[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]{margin-left:15px}.table-filter[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .table-filter[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{height:34px;border-radius:3px;border-color:#ddd;box-shadow:none}.table-filter[_ngcontent-%COMP%]{padding:5px 0 15px;border-bottom:1px solid #e9e9e9;margin-bottom:5px}.table-filter[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{height:34px}.table-filter[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:400;margin:auto 10px auto 0}.table-filter[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap}.table-filter[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .table-filter[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:inline-block;margin-left:5px}.table-filter[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:200px}.filter-group[_ngcontent-%COMP%]   select.form-select[_ngcontent-%COMP%]{width:110px}.filter-icon[_ngcontent-%COMP%]{margin-top:7px}.filter-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:18px;opacity:.7}table.table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table.table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-color:#e9e9e9;padding:12px 15px;vertical-align:middle}.table-wrapper[_ngcontent-%COMP%]   table.table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{cursor:pointer}.table-wrapper[_ngcontent-%COMP%]   table.table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child{width:60px}.table-wrapper[_ngcontent-%COMP%]   table.table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child{width:80px}.table-wrapper[_ngcontent-%COMP%]   table.table-striped[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-of-type(odd){background-color:#fcfcfc}.table-wrapper[_ngcontent-%COMP%]   table.table-striped.table-hover[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#f5f5f5}.table-wrapper[_ngcontent-%COMP%]   table.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:13px;margin:0 5px;cursor:pointer}.table-wrapper[_ngcontent-%COMP%]   table.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-weight:400;color:#566787;display:inline-block;text-decoration:none;white-space:nowrap}.table-wrapper[_ngcontent-%COMP%]   table.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child   a[_ngcontent-%COMP%]{font-weight:700}.table-wrapper[_ngcontent-%COMP%]   table.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#2196f3}.table-wrapper[_ngcontent-%COMP%]   table.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   a.view[_ngcontent-%COMP%]{font-weight:400;width:30px;height:30px;color:#1383df;text-align:center}.table-wrapper[_ngcontent-%COMP%]   table.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   a.view[_ngcontent-%COMP%]:hover{color:#0e5086}.table-wrapper[_ngcontent-%COMP%]   table.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   a.view[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:22px;margin:2px 0 0 1px}.table-wrapper[_ngcontent-%COMP%]   table.table[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{width:40px;border-radius:50%;vertical-align:middle;margin-right:10px}.text-success[_ngcontent-%COMP%]{color:#10c469}.text-info[_ngcontent-%COMP%]{color:#62c9e8}.text-warning[_ngcontent-%COMP%]{color:#ffc107}.text-danger[_ngcontent-%COMP%]{color:#ff5b5b}.pagination[_ngcontent-%COMP%]{float:right;margin:0 0 5px}.pagination[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .pagination[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:none;font-size:13px;min-width:30px;min-height:30px;color:#353434;margin:0 2px;line-height:30px;border-radius:2px!important;text-align:center;padding:0 6px}.pagination[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .pagination[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:#383737}.pagination[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .pagination[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:#353434;background:#03a9f4}.pagination[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .pagination[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:#383737;background:#0397d6}.pagination[_ngcontent-%COMP%]   li.disabled[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#ccc}.pagination[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px;padding-top:6px}.hint-text[_ngcontent-%COMP%]{float:left;margin-top:10px;font-size:13px}.store[_ngcontent-%COMP%]{text-align:center;font-size:14px;color:gray;margin-bottom:-10px}.dropdown[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-align:start;font-weight:400}.fa-spinner[_ngcontent-%COMP%]{color:#ffc107}.fa-ship[_ngcontent-%COMP%]{color:#0dcaf0}.fa-truck-fast[_ngcontent-%COMP%]{color:#198754}.fa-ban[_ngcontent-%COMP%]{color:#dc3545}.fa-gear[_ngcontent-%COMP%]{font-size:25px}']})};var he=(o,r)=>sessionStorage.getItem("username")?!0:tt(L).navigate(["auth/login"]);var Xn=[{path:"",component:Ae},{path:"profile",component:$e,canActivate:[he]},{path:"cart",component:Be,canActivate:[he]},{path:"checkout",component:ze,canActivate:[he]},{path:"purchases",component:Re,canActivate:[he]}],Ge=class o{static \u0275fac=function(e){return new(e||o)};static \u0275mod=ye({type:o});static \u0275inj=ve({imports:[He.forChild(Xn),we,He]})};var gt=class o{static \u0275fac=function(e){return new(e||o)};static \u0275mod=ye({type:o});static \u0275inj=ve({imports:[we,Ge,pt,ct,mt]})};export{gt as DashboardModule};
